import{Q as M}from"./@element-plus-tztFf6PP.js";import{n as D,d as A,h as U,m as E,j as K,f as j,i as Q,$ as X,ag as _,o as u,c as V,X as o,T as l,S as g,q as R,a as F,v,x as y,F as O,p as L,aq as G,U as J,W as x,u as Y,e as Z}from"./@vue-CRBWlwId.js";import{_ as ee,l as le,m as oe,h as te,i as ne}from"./index-BfYElSN2.js";import{a as z}from"./element-plus-C9Ov05af.js";const se=()=>new Promise((n,p)=>{D(()=>{const c=document.styleSheets;let d=[],e=[];for(let a=0;a<c.length;a++)c[a].href&&c[a].href.indexOf("at.alicdn.com")>-1&&d.push(c[a]);for(let a=0;a<d.length;a++)for(let m=0;m<d[a].cssRules.length;m++)d[a].cssRules[m].selectorText&&d[a].cssRules[m].selectorText.indexOf(".icon-")>-1&&e.push(`${d[a].cssRules[m].selectorText.substring(1,d[a].cssRules[m].selectorText.length).replace(/\:\:before/gi,"")}`);e.length>0?n(e):p("未获取到值，请刷新重试")})}),ae=()=>new Promise((n,p)=>{D(()=>{const c=M,d=[];for(const e in c)d.push(`ele-${c[e].name}`);d.length>0?n(d):p("未获取到值，请刷新重试")})}),re=()=>new Promise((n,p)=>{D(()=>{const c=document.styleSheets;let d=[],e=[];for(let a=0;a<c.length;a++)c[a].href&&c[a].href.indexOf("netdna.bootstrapcdn.com")>-1&&d.push(c[a]);for(let a=0;a<d.length;a++)for(let m=0;m<d[a].cssRules.length;m++)d[a].cssRules[m].selectorText&&d[a].cssRules[m].selectorText.indexOf(".fa-")===0&&d[a].cssRules[m].selectorText.indexOf(",")===-1&&/::before/.test(d[a].cssRules[m].selectorText)&&e.push(`${d[a].cssRules[m].selectorText.substring(1,d[a].cssRules[m].selectorText.length).replace(/\:\:before/gi,"")}`);e.length>0?n(e.reverse()):p("未获取到值，请刷新重试")})}),N={ali:()=>se(),ele:()=>ae(),awe:()=>re()},ue=A({name:"iconSelector",emits:["update:modelValue","get","clear"],props:{prepend:{type:String,default:()=>"ele-Pointer"},placeholder:{type:String,default:()=>"请输入内容搜索图标或者选择图标"},size:{type:String,default:()=>"default"},title:{type:String,default:()=>"请选择图标"},type:{type:String,default:()=>"ele"},disabled:{type:Boolean,default:()=>!1},clearable:{type:Boolean,default:()=>!0},emptyDescription:{type:String,default:()=>"无相关图标"},modelValue:String},setup(n,{emit:p}){const c=U(),d=U(),e=E({fontIconPrefix:"",fontIconWidth:0,fontIconSearch:"",fontIconTabsIndex:0,fontIconSheetsList:[],fontIconPlaceholder:"",fontIconType:"ali",fontIconShow:!0}),a=()=>{if(!n.modelValue)return!1;e.fontIconSearch="",e.fontIconPlaceholder=n.modelValue},m=()=>{setTimeout(()=>{e.fontIconSheetsList.filter(I=>I===e.fontIconSearch).length<=0&&(e.fontIconSearch="")},300)},S=()=>{if(n.modelValue==="")return e.fontIconPlaceholder=n.placeholder;e.fontIconPlaceholder=n.modelValue,e.fontIconPrefix=n.modelValue},P=()=>{var f,I,b;((f=n.modelValue)==null?void 0:f.indexOf("iconfont"))>-1?r("ali"):((I=n.modelValue)==null?void 0:I.indexOf("ele-"))>-1?r("ele"):((b=n.modelValue)==null?void 0:b.indexOf("fa"))>-1?r("awe"):r("ali")},T=K(()=>{if(!e.fontIconSearch)return e.fontIconSheetsList;let f=e.fontIconSearch.trim().toLowerCase();return e.fontIconSheetsList.filter(I=>{if(I.toLowerCase().indexOf(f)!==-1)return I})}),h=()=>{D(()=>{e.fontIconWidth=c.value.$el.offsetWidth})},s=()=>{window.addEventListener("resize",()=>{h()})},C=async f=>{e.fontIconSheetsList=[],f==="ali"?await N.ali().then(I=>{e.fontIconSheetsList=I.map(b=>`iconfont ${b}`)}):f==="ele"?await N.ele().then(I=>{e.fontIconSheetsList=I}):f==="awe"&&await N.awe().then(I=>{e.fontIconSheetsList=I.map(b=>`fa ${b}`)}),e.fontIconPlaceholder=n.placeholder,S()},r=f=>{e.fontIconType=f,C(f)},i=f=>{e.fontIconPlaceholder=f,e.fontIconPrefix=f,p("get",e.fontIconPrefix),p("update:modelValue",e.fontIconPrefix)},w=()=>{e.fontIconPrefix="",p("clear",e.fontIconPrefix),p("update:modelValue",e.fontIconPrefix)},k=()=>{S(),P()};return j(()=>{S(),s(),h()}),Q(()=>n.modelValue,()=>{S()}),{inputWidthRef:c,selectorScrollbarRef:d,fontIconSheetsFilterList:T,onColClick:i,onIconChange:r,onClearFontIcon:w,onIconFocus:a,onIconBlur:m,onPopoverShow:k,...X(e)}}}),ie={class:"icon-selector w100 h100"},de={class:"icon-selector-warp"},me={class:"icon-selector-warp-title flex"},ce={class:"flex-auto"},fe={key:0,class:"icon-selector-warp-title-tab"},pe={class:"icon-selector-warp-row"},ge={class:"flex-margin"},_e={class:"icon-selector-warp-item-value"};function he(n,p,c,d,e,a){const m=_("SvgIcon"),S=_("el-input"),P=_("el-col"),T=_("el-row"),h=_("el-empty"),s=_("el-scrollbar"),C=_("el-popover");return u(),V("div",ie,[o(C,{placement:"bottom",width:n.fontIconWidth,trigger:"click",transition:"el-zoom-in-top","popper-class":"icon-selector-popper",onShow:n.onPopoverShow},{reference:l(()=>[o(S,{modelValue:n.fontIconSearch,"onUpdate:modelValue":p[0]||(p[0]=r=>n.fontIconSearch=r),placeholder:n.fontIconPlaceholder,clearable:n.clearable,disabled:n.disabled,size:n.size,ref:"inputWidthRef",onClear:n.onClearFontIcon,onFocus:n.onIconFocus,onBlur:n.onIconBlur},{prepend:l(()=>{var r,i;return[(n.fontIconPrefix===""?((r=n.prepend)==null?void 0:r.indexOf("ele-"))>-1:((i=n.fontIconPrefix)==null?void 0:i.indexOf("ele-"))>-1)?(u(),g(m,{key:0,name:n.fontIconPrefix===""?n.prepend:n.fontIconPrefix,class:"font14"},null,8,["name"])):(u(),V("i",{key:1,class:R([n.fontIconPrefix===""?n.prepend:n.fontIconPrefix,"font14"])},null,2))]}),_:1},8,["modelValue","placeholder","clearable","disabled","size","onClear","onFocus","onBlur"])]),default:l(()=>[F("div",de,[F("div",me,[F("div",ce,v(n.title),1),n.type==="all"?(u(),V("div",fe,[F("span",{class:R([{"span-active":n.fontIconType==="ali"},"ml10"]),onClick:p[1]||(p[1]=r=>n.onIconChange("ali")),title:"iconfont 图标"},"ali",2),F("span",{class:R([{"span-active":n.fontIconType==="ele"},"ml10"]),onClick:p[2]||(p[2]=r=>n.onIconChange("ele")),title:"elementPlus 图标"},"ele",2),F("span",{class:R([{"span-active":n.fontIconType==="awe"},"ml10"]),onClick:p[3]||(p[3]=r=>n.onIconChange("awe")),title:"fontawesome 图标"},"awe",2)])):y("",!0)]),F("div",pe,[o(s,{ref:"selectorScrollbarRef"},{default:l(()=>[n.fontIconSheetsFilterList.length>0?(u(),g(T,{key:0,gutter:10},{default:l(()=>[(u(!0),V(O,null,L(n.fontIconSheetsFilterList,(r,i)=>(u(),g(P,{xs:6,sm:4,md:4,lg:4,xl:4,onClick:w=>n.onColClick(r),key:i},{default:l(()=>[F("div",{class:R(["icon-selector-warp-item",{"icon-selector-active":n.fontIconPrefix===r}])},[F("div",ge,[F("div",_e,[o(m,{name:r},null,8,["name"])])])],2)]),_:2},1032,["onClick"]))),128))]),_:1})):y("",!0),n.fontIconSheetsFilterList.length<=0?(u(),g(h,{key:1,"image-size":100,description:n.emptyDescription},null,8,["description"])):y("",!0)]),_:1},512)])])]),_:1},8,["width","onShow"])])}const Ie=ee(ue,[["render",he]]),Fe={class:"system-menu-container"},ye={style:{"font-size":"large"}},Ve=F("i",{class:"fa fa-exclamation-circle ml10 mt10"},null,-1),be=F("i",{class:"fa fa-exclamation-circle ml10 mt10"},null,-1),we=F("i",{class:"fa fa-exclamation-circle ml10 mt10"},null,-1),xe=F("i",{class:"fa fa-exclamation-circle ml10 mt10"},null,-1),Se={class:"dialog-footer"},Le=A({__name:"editMenu",props:{title:{type:String,default:()=>""}},setup(n,{expose:p}){const{proxy:c}=Z(),d=U(null),e=E({isShowDialog:!1,loading:!1,ruleForm:{menuId:0,menuName:"",menuType:"",parentId:0,component:"",path:"",sort:1,status:"",title:"",icon:"",isHide:"",isKeepAlive:"",isAffix:"",isLink:"",isIframe:"",permission:"",remark:""},isHideOptions:[],statusOptions:[],menuTypeOptions:[],yesOrNoOptions:[],menuOptions:[],ruleRules:{menuName:[{required:!0,message:"菜单名称不能为空",trigger:"blur"}],parentId:[{required:!0,message:"父菜单不能为空",trigger:"blur"}],menuType:[{required:!0,message:"菜单类型不能为空",trigger:"blur"}],status:[{required:!0,message:"菜单状态不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"菜单顺序不能为空",trigger:"blur"}]}}),a=h=>{h.menuId&&h.menuId!=null&&h.menuId!=0?e.ruleForm=h:(T(),e.ruleForm.parentId=h.parentId),e.isShowDialog=!0,e.loading=!1,c.getDicts("sys_show_hide").then(s=>{e.isHideOptions=s.rows}),c.getDicts("sys_normal_disable").then(s=>{e.statusOptions=s.rows}),c.getDicts("sys_menu_type").then(s=>{e.menuTypeOptions=s.rows}),c.getDicts("sys_num_yes_no").then(s=>{e.yesOrNoOptions=s.rows}),le("/sys/menu",{}).then(s=>{s.rows.unshift({menuId:0,menuName:"顶级菜单"}),e.menuOptions=oe(s.rows,"menuId","parentId","children")})},m=h=>{T(),c.mittBus.emit("onEditMenuModule",h),e.isShowDialog=!1},S=()=>{m(),T()},P=()=>{const h=Y(d);h&&h.validate(s=>{s&&(e.ruleForm.component==""&&(e.ruleForm.menuType=="F"?e.ruleForm.component="":e.ruleForm.component="Layout"),e.loading=!0,e.ruleForm.menuId!=null&&e.ruleForm.menuId!=0?te("/sys/menu",e.ruleForm).then(()=>{z.success("修改成功"),e.loading=!1,m()}).finally(()=>{e.loading=!1}):ne("/sys/menu",e.ruleForm).then(()=>{z.success("新增成功"),e.loading=!1,m()}).finally(()=>{e.loading=!1}))})},T=()=>{e.ruleForm.menuId=0,e.ruleForm.menuName="",e.ruleForm.menuType="",e.ruleForm.parentId=0,e.ruleForm.component="",e.ruleForm.path="",e.ruleForm.orderNum=1,e.ruleForm.status="",e.ruleForm.title="",e.ruleForm.icon="",e.ruleForm.isHide="",e.ruleForm.isKeepAlive="",e.ruleForm.isAffix="",e.ruleForm.isLink="",e.ruleForm.isIframe="",e.ruleForm.permission="",e.ruleForm.remark=""};return p({openDialog:a}),(h,s)=>{const C=_("el-cascader"),r=_("el-form-item"),i=_("el-col"),w=_("el-radio"),k=_("el-radio-group"),f=_("el-input"),I=_("el-input-number"),b=_("el-tooltip"),$=_("el-row"),W=_("el-form"),B=_("el-button"),q=_("el-dialog"),H=G("drag");return u(),V("div",Fe,[o(q,{modelValue:e.isShowDialog,"onUpdate:modelValue":s[15]||(s[15]=t=>e.isShowDialog=t),width:"769px",center:""},{title:l(()=>[J((u(),V("div",ye,[x(v(n.title),1)])),[[H,[".system-menu-container .el-dialog",".system-menu-container .el-dialog__header"]]])]),footer:l(()=>[F("span",Se,[o(B,{onClick:S},{default:l(()=>[x("取 消")]),_:1}),o(B,{type:"primary",onClick:P,loading:e.loading},{default:l(()=>[x("编 辑")]),_:1},8,["loading"])])]),default:l(()=>[o(W,{model:e.ruleForm,rules:e.ruleRules,ref_key:"ruleFormRef",ref:d,"label-width":"80px"},{default:l(()=>[o($,{gutter:35},{default:l(()=>[o(i,{span:24},{default:l(()=>[o(r,{label:"上级菜单",prop:"parentId"},{default:l(()=>[o(C,{modelValue:e.ruleForm.parentId,"onUpdate:modelValue":s[0]||(s[0]=t=>e.ruleForm.parentId=t),options:e.menuOptions,class:"w100",props:{label:"menuName",value:"menuId",checkStrictly:!0,emitPath:!1},clearable:"",filterable:"",placeholder:"选择上级菜单","show-all-levels":!1},null,8,["modelValue","options"])]),_:1})]),_:1}),o(i,{span:24},{default:l(()=>[o(r,{label:"菜单类型",prop:"menuType"},{default:l(()=>[o(k,{modelValue:e.ruleForm.menuType,"onUpdate:modelValue":s[1]||(s[1]=t=>e.ruleForm.menuType=t)},{default:l(()=>[(u(!0),V(O,null,L(e.menuTypeOptions,t=>(u(),g(w,{key:t.dictValue,label:t.dictValue},{default:l(()=>[x(v(t.dictLabel),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(i,{xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[o(r,{label:"菜单名称",prop:"menuName"},{default:l(()=>[o(f,{modelValue:e.ruleForm.menuName,"onUpdate:modelValue":s[2]||(s[2]=t=>e.ruleForm.menuName=t),placeholder:"请输入菜单名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),o(i,{xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[o(r,{label:"菜单排序",prop:"sort"},{default:l(()=>[o(I,{modelValue:e.ruleForm.sort,"onUpdate:modelValue":s[3]||(s[3]=t=>e.ruleForm.sort=t),placeholder:"菜单排序",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e.ruleForm.menuType!="F"?(u(),g(i,{key:0,xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[o(r,{label:"菜单图标",prop:"icon"},{default:l(()=>[o(Ie,{placeholder:"请输入菜单图标",modelValue:e.ruleForm.icon,"onUpdate:modelValue":s[4]||(s[4]=t=>e.ruleForm.icon=t),type:"all"},null,8,["modelValue"])]),_:1})]),_:1})):y("",!0),o(i,{xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[o($,{gutter:8},{default:l(()=>[o(i,{span:22},{default:l(()=>[o(r,{label:"权限标识",prop:"permission"},{default:l(()=>[o(f,{modelValue:e.ruleForm.permission,"onUpdate:modelValue":s[5]||(s[5]=t=>e.ruleForm.permission=t),placeholder:"路由权限标识",clearable:"",disabled:e.ruleForm.menuType=="M"},null,8,["modelValue","disabled"])]),_:1})]),_:1}),o(i,{span:2},{default:l(()=>[o(b,{content:"路由权限标识（多个请用逗号隔开）",placement:"top"},{default:l(()=>[Ve]),_:1})]),_:1})]),_:1})]),_:1}),e.ruleForm.menuType!="F"?(u(),g(i,{key:1,xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[o($,{gutter:8},{default:l(()=>[o(i,{span:22},{default:l(()=>[o(r,{label:"组件地址"},{default:l(()=>[o(f,{modelValue:e.ruleForm.component,"onUpdate:modelValue":s[6]||(s[6]=t=>e.ruleForm.component=t),placeholder:"组件地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),o(i,{span:2},{default:l(()=>[o(b,{content:"菜单对应的具体vue页面文件路径views的下级路径/system/user/index,外链请填写/layout/routerView/link，内链请填写/layout/routerView/iframes",placement:"top"},{default:l(()=>[be]),_:1})]),_:1})]),_:1})]),_:1})):y("",!0),e.ruleForm.menuType!="F"?(u(),g(i,{key:2,xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[o($,{gutter:8},{default:l(()=>[o(i,{span:22},{default:l(()=>[o(r,{label:"路由地址"},{default:l(()=>[o(f,{modelValue:e.ruleForm.path,"onUpdate:modelValue":s[7]||(s[7]=t=>e.ruleForm.path=t),placeholder:"请输入路由地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),o(i,{span:2},{default:l(()=>[o(b,{content:"要和页面name保持一致:例如 /system/role",placement:"top"},{default:l(()=>[we]),_:1})]),_:1})]),_:1})]),_:1})):y("",!0),o(i,{xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[o(r,{label:"菜单状态",prop:"status"},{default:l(()=>[o(k,{modelValue:e.ruleForm.status,"onUpdate:modelValue":s[8]||(s[8]=t=>e.ruleForm.status=t)},{default:l(()=>[(u(!0),V(O,null,L(e.statusOptions,t=>(u(),g(w,{key:t.dictValue,label:t.dictValue},{default:l(()=>[x(v(t.dictLabel),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e.ruleForm.menuType!="F"?(u(),g(i,{key:3,xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[o(r,{label:"是否隐藏"},{default:l(()=>[o(k,{modelValue:e.ruleForm.isHide,"onUpdate:modelValue":s[9]||(s[9]=t=>e.ruleForm.isHide=t)},{default:l(()=>[(u(!0),V(O,null,L(e.isHideOptions,t=>(u(),g(w,{key:t.dictValue,label:t.dictValue},{default:l(()=>[x(v(t.dictLabel),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):y("",!0),e.ruleForm.menuType!="F"?(u(),g(i,{key:4,xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[o(r,{label:"是否缓存"},{default:l(()=>[o(k,{modelValue:e.ruleForm.isKeepAlive,"onUpdate:modelValue":s[10]||(s[10]=t=>e.ruleForm.isKeepAlive=t)},{default:l(()=>[(u(!0),V(O,null,L(e.yesOrNoOptions,t=>(u(),g(w,{key:t.dictValue,label:t.dictValue},{default:l(()=>[x(v(t.dictLabel),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):y("",!0),e.ruleForm.menuType!="F"?(u(),g(i,{key:5,xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[o($,{gutter:8},{default:l(()=>[o(i,{span:22},{default:l(()=>[o(r,{label:"是否固定"},{default:l(()=>[o(k,{modelValue:e.ruleForm.isAffix,"onUpdate:modelValue":s[11]||(s[11]=t=>e.ruleForm.isAffix=t)},{default:l(()=>[(u(!0),V(O,null,L(e.yesOrNoOptions,t=>(u(),g(w,{key:t.dictValue,label:t.dictValue},{default:l(()=>[x(v(t.dictLabel),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(i,{span:2},{default:l(()=>[e.ruleForm.menuType!="F"?(u(),g(b,{key:0,content:"是否要固定到tag头部",placement:"top"},{default:l(()=>[xe]),_:1})):y("",!0)]),_:1})]),_:1})]),_:1})):y("",!0),e.ruleForm.menuType!="F"?(u(),g(i,{key:6,xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[o(r,{label:"是否内嵌"},{default:l(()=>[o(k,{modelValue:e.ruleForm.isIframe,"onUpdate:modelValue":s[12]||(s[12]=t=>e.ruleForm.isIframe=t)},{default:l(()=>[(u(!0),V(O,null,L(e.yesOrNoOptions,t=>(u(),g(w,{key:t.dictValue,label:t.dictValue},{default:l(()=>[x(v(t.dictLabel),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):y("",!0),e.ruleForm.menuType!="F"?(u(),g(i,{key:7,xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[o(r,{label:"链接地址"},{default:l(()=>[o(f,{modelValue:e.ruleForm.isLink,"onUpdate:modelValue":s[13]||(s[13]=t=>e.ruleForm.isLink=t),placeholder:"外链/内嵌时链接地址（http://***.com）",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})):y("",!0),o(i,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[o(r,{label:"备注"},{default:l(()=>[o(f,{modelValue:e.ruleForm.remark,"onUpdate:modelValue":s[14]||(s[14]=t=>e.ruleForm.remark=t),placeholder:"请输入备注内容",clearable:"",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});export{Le as _};
