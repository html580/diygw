import{l as f,x as P,m as j,h as W,i as z,_ as H}from"./index-BfYElSN2.js";import{a as w}from"./element-plus-C9Ov05af.js";import{d as X,h as $,m as A,ag as a,aq as G,o as d,c as p,X as o,T as r,U as J,W as _,v as h,a as K,S as i,x as k,F as c,p as g,u as Q,e as Y}from"./@vue-CRBWlwId.js";import"./pinia-BTdriGDs.js";import"./vue-router-B8aOcPyE.js";import"./vue-i18n-Bpsr_IBC.js";import"./@intlify-Bn43FqoL.js";import"./vue-DEEPytDe.js";import"./js-cookie-Cz0CWeBA.js";import"./@element-plus-tztFf6PP.js";import"./nprogress-B-yuMcN-.js";import"./axios-Ds1py3KQ.js";import"./lodash-CnNYTNB6.js";import"./mitt-DJ65BbbF.js";import"./file-saver-B2L8jjWN.js";import"./diygw-datav-DLF-c6uN.js";import"./lodash-es-CW97kIZl.js";import"./@vueuse-BIgT8fdk.js";import"./@popperjs-CER6Qr1e.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-r8A8W4xn.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-DwF5HINA.js";import"./escape-html-HzfLCvW4.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DuJrlvqV.js";const Z={class:"system-menu-container"},ee={style:{"font-size":"large"}},le={class:"dialog-footer"},oe=X({__name:"editModule",props:{title:{type:String,default:()=>""}},setup(O,{expose:D}){const{proxy:F}=Y(),b=$(null),e=A({isShowDialog:!1,loading:!1,sexOptions:[],roleOptions:[],statusOptions:[],deptOptions:[],postOptions:[],ruleForm:{userId:void 0,username:"",nickname:"",deptId:"",roleId:"",postId:"",phone:"",email:"",status:"",password:"",avatar:"",sex:"",remark:"",postIds:"",roleIds:""},postIds:[],roleIds:[],isHideOptions:[],menuTypeOptions:[],yesOrNoOptions:[],menuOptions:[],ruleRules:{username:[{required:!0,message:"用户名称不能为空",trigger:"blur"}],nickname:[{required:!0,message:"用户昵称不能为空",trigger:"blur"}],password:[{required:!0,message:"用户密码不能为空",trigger:"blur"}],email:[{type:"email",message:"'请输入正确的邮箱地址",trigger:["blur","change"]}],phone:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]}}),U=t=>{t&&t.userId&&t.userId!=null&&t.userId!=0?Promise.all([f("/sys/post",{}),f("/sys/role",{}),P("/sys/user",t.userId)]).then(s=>{e.postOptions=s[0].rows,e.roleOptions=s[1].rows,e.ruleForm=s[2].data,e.ruleForm.postIds?e.postIds=e.ruleForm.postIds.split(",").map(n=>Number(n)):e.postIds=[],e.ruleForm.roleIds?e.roleIds=e.ruleForm.roleIds.split(",").map(n=>Number(n)):e.roleIds=[],e.ruleForm.password=""}).then(()=>{}):y(),S(),e.isShowDialog=!0,e.loading=!1,F.getDicts("sys_user_sex").then(s=>{e.sexOptions=s.rows}),F.getDicts("sys_normal_disable").then(s=>{e.statusOptions=s.rows})},I=t=>{F.mittBus.emit("onEditUserModule",t),e.isShowDialog=!1},N=()=>{I(),y()},S=async()=>{f("/sys/dept",{}).then(t=>{e.deptOptions=j(t.rows,"deptId","parentId","children")})},C=()=>{const t=Q(b);t&&t.validate(s=>{s&&(e.ruleForm.postId=e.postIds[0],e.ruleForm.roleId=e.roleIds[0],e.ruleForm.postIds=e.postIds.join(","),e.ruleForm.roleIds=e.roleIds.join(","),e.loading=!0,e.ruleForm.userId!=null?W("/sys/user",e.ruleForm).then(()=>{w.success("修改成功"),e.loading=!1,I()}).finally(()=>{e.loading=!1}):z("/sys/user",e.ruleForm).then(()=>{w.success("新增成功"),e.loading=!1,I()}).finally(()=>{e.loading=!1}))})},y=()=>{Promise.all([f("/sys/post",{}),f("/sys/role",{})]).then(t=>{e.postOptions=t[0].rows,e.roleOptions=t[1].rows}),e.ruleForm.userId=void 0,e.ruleForm.username="",e.ruleForm.nickname="",e.ruleForm.deptId="",e.ruleForm.phone="",e.ruleForm.email="",e.ruleForm.status="",e.ruleForm.password="",e.ruleForm.avatar="",e.ruleForm.sex="",e.ruleForm.remark="",e.ruleForm.postIds="",e.ruleForm.roleIds=""};return D({openDialog:U}),(t,s)=>{const n=a("el-input"),u=a("el-form-item"),m=a("el-col"),B=a("el-cascader"),x=a("el-option"),V=a("el-select"),T=a("el-radio"),q=a("el-radio-group"),E=a("el-row"),M=a("el-form"),v=a("el-button"),R=a("el-dialog"),L=G("drag");return d(),p("div",Z,[o(R,{modelValue:e.isShowDialog,"onUpdate:modelValue":s[11]||(s[11]=l=>e.isShowDialog=l),width:"769px",center:""},{title:r(()=>[J((d(),p("div",ee,[_(h(O.title),1)])),[[L,[".system-menu-container .el-dialog",".system-menu-container .el-dialog__header"]]])]),footer:r(()=>[K("span",le,[o(v,{onClick:N},{default:r(()=>[_("取 消")]),_:1}),o(v,{type:"primary",onClick:C,loading:e.loading},{default:r(()=>[_("编 辑")]),_:1},8,["loading"])])]),default:r(()=>[o(M,{ref_key:"ruleFormRef",ref:b,model:e.ruleForm,rules:e.ruleRules,"label-width":"80px"},{default:r(()=>[o(E,{gutter:35},{default:r(()=>[o(m,{xs:24,sm:12,md:12,lg:12,xl:12},{default:r(()=>[o(u,{label:"用户昵称",prop:"nickname"},{default:r(()=>[o(n,{modelValue:e.ruleForm.nickname,"onUpdate:modelValue":s[0]||(s[0]=l=>e.ruleForm.nickname=l),placeholder:"请输入用户昵称"},null,8,["modelValue"])]),_:1})]),_:1}),o(m,{xs:24,sm:12,md:12,lg:12,xl:12},{default:r(()=>[o(u,{label:"归属部门",prop:"deptId"},{default:r(()=>[o(B,{modelValue:e.ruleForm.deptId,"onUpdate:modelValue":s[1]||(s[1]=l=>e.ruleForm.deptId=l),options:e.deptOptions,props:{label:"deptName",value:"deptId",checkStrictly:!0,emitPath:!1},class:"w100",clearable:"",filterable:"",placeholder:"请选择归属部门","show-all-levels":!1},null,8,["modelValue","options"])]),_:1})]),_:1}),o(m,{xs:24,sm:12,md:12,lg:12,xl:12},{default:r(()=>[e.ruleForm.userId==null?(d(),i(u,{key:0,label:"用户名称",prop:"username"},{default:r(()=>[o(n,{modelValue:e.ruleForm.username,"onUpdate:modelValue":s[2]||(s[2]=l=>e.ruleForm.username=l),placeholder:"请输入用户名称"},null,8,["modelValue"])]),_:1})):k("",!0)]),_:1}),o(m,{xs:24,sm:12,md:12,lg:12,xl:12},{default:r(()=>[e.ruleForm.userId==null?(d(),i(u,{key:0,label:"用户密码",prop:"password"},{default:r(()=>[o(n,{modelValue:e.ruleForm.password,"onUpdate:modelValue":s[3]||(s[3]=l=>e.ruleForm.password=l),placeholder:"请输入用户密码",type:"password"},null,8,["modelValue"])]),_:1})):k("",!0)]),_:1}),o(m,{xs:24,sm:12,md:12,lg:12,xl:12},{default:r(()=>[o(u,{label:"手机号码",prop:"phone"},{default:r(()=>[o(n,{modelValue:e.ruleForm.phone,"onUpdate:modelValue":s[4]||(s[4]=l=>e.ruleForm.phone=l),placeholder:"请输入手机号码",maxlength:"11"},null,8,["modelValue"])]),_:1})]),_:1}),o(m,{xs:24,sm:12,md:12,lg:12,xl:12},{default:r(()=>[o(u,{label:"邮箱",prop:"email"},{default:r(()=>[o(n,{modelValue:e.ruleForm.email,"onUpdate:modelValue":s[5]||(s[5]=l=>e.ruleForm.email=l),placeholder:"请输入邮箱",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),o(m,{xs:24,sm:12,md:12,lg:12,xl:12},{default:r(()=>[o(u,{label:"用户性别",prop:"sex"},{default:r(()=>[o(V,{class:"w100",modelValue:e.ruleForm.sex,"onUpdate:modelValue":s[6]||(s[6]=l=>e.ruleForm.sex=l),placeholder:"请选择"},{default:r(()=>[(d(!0),p(c,null,g(e.sexOptions,l=>(d(),i(x,{key:l.dictValue,label:l.dictLabel,value:l.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(m,{xs:24,sm:12,md:12,lg:12,xl:12},{default:r(()=>[o(u,{label:"状态"},{default:r(()=>[o(q,{modelValue:e.ruleForm.status,"onUpdate:modelValue":s[7]||(s[7]=l=>e.ruleForm.status=l)},{default:r(()=>[(d(!0),p(c,null,g(e.statusOptions,l=>(d(),i(T,{key:l.dictValue,label:l.dictValue},{default:r(()=>[_(h(l.dictLabel),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(m,{xs:24,sm:12,md:12,lg:12,xl:12},{default:r(()=>[o(u,{label:"岗位"},{default:r(()=>[o(V,{class:"w100",modelValue:e.postIds,"onUpdate:modelValue":s[8]||(s[8]=l=>e.postIds=l),multiple:"","collapse-tags":"true",placeholder:"请选择"},{default:r(()=>[(d(!0),p(c,null,g(e.postOptions,l=>(d(),i(x,{key:l.postId,label:l.postName,value:l.postId,disabled:l.status==1},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(m,{xs:24,sm:12,md:12,lg:12,xl:12},{default:r(()=>[o(u,{label:"角色"},{default:r(()=>[o(V,{class:"w100",modelValue:e.roleIds,"onUpdate:modelValue":s[9]||(s[9]=l=>e.roleIds=l),multiple:"","collapse-tags":"true",placeholder:"请选择"},{default:r(()=>[(d(!0),p(c,null,g(e.roleOptions,l=>(d(),i(x,{key:l.roleId,label:l.roleName,value:l.roleId,disabled:l.status==1},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(m,{xs:24,sm:24,md:24,lg:24,xl:24},{default:r(()=>[o(u,{label:"备注"},{default:r(()=>[o(n,{modelValue:e.ruleForm.remark,"onUpdate:modelValue":s[10]||(s[10]=l=>e.ruleForm.remark=l),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}}),Ue=H(oe,[["__scopeId","data-v-6b2036f6"]]);export{Ue as default};
