import{b as te,u as le}from"./vue-router-B8aOcPyE.js";import{s as oe}from"./pinia-BTdriGDs.js";import{_ as ie,g as se,h as ne,i as ae,j as F,l as re,k as de,c as ue}from"./index-BfYElSN2.js";import{D as me}from"./uploadinput-CMX3D0tT.js";import{D as ce}from"./photo-CjUoS7r5.js";import{_ as pe}from"./index-DYzGsnaq.js";import{_ as _e}from"./index-DDnfpf_Y.js";import{ag as a,aq as ge,o as c,c as w,a as n,X as e,T as s,W as d,U as B,S as _,x as S,Y as he,q as fe,F as T,p as q,v as A,bn as ye,bl as be}from"./@vue-CRBWlwId.js";import{a as y,E as Q}from"./element-plus-C9Ov05af.js";import"./vue-i18n-Bpsr_IBC.js";import"./@intlify-Bn43FqoL.js";import"./vue-DEEPytDe.js";import"./js-cookie-Cz0CWeBA.js";import"./@element-plus-tztFf6PP.js";import"./nprogress-B-yuMcN-.js";import"./axios-Ds1py3KQ.js";import"./lodash-CnNYTNB6.js";import"./mitt-DJ65BbbF.js";import"./file-saver-B2L8jjWN.js";import"./diygw-datav-DLF-c6uN.js";import"./lodash-es-CW97kIZl.js";import"./@vueuse-BIgT8fdk.js";import"./@popperjs-CER6Qr1e.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-r8A8W4xn.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-DwF5HINA.js";import"./escape-html-HzfLCvW4.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DuJrlvqV.js";import"./vue-draggable-plus-D90yCKwz.js";import"./vue-ueditor-wrap-B1amLqDs.js";const we={components:{DiyUploadinput:me,DiyPhoto:ce,DiySku:pe,DiyEditor:_e},data(){return{globalOption:{},userInfo:{},ordernum:{code:200,msg:"设置成功"},updatenum:{code:200,msg:"修改成功",data:{id:"1",sortnum:"0"}},cates:{rows:[{id:0,title:"",remark:null,img:"",sortnum:null,status:"",userId:0,createTime:"",updateTime:"",deleteTime:null}],total:0,code:0,msg:""},loading:!0,ids:[],single:!0,multiple:!0,title:"",total:0,tableData:[],isFullscreen:!1,isShowDialog:!1,saveloading:!1,tabsTab:"1",editFormInit:{},queryParamsInit:{},editFormData:{statusDatas:[{value:"1",label:"上架"},{value:"2",label:"下架"}],skuTypeDatas:[{value:"1",label:"单规格"},{value:"2",label:"多规格"}],skusColumns:[{title:"图片地址",id:"thumb",type:"img"},{title:"价格",id:"price",type:"number"},{title:"划线价格",id:"linePrice",type:"number"},{title:"库存",id:"amount",type:"number"},{title:"备注",id:"sku",type:"text"}]},queryParams:{pageNum:1,pageSize:10,title_like:""},queryParamsRules:{},editForm:{id:void 0,title:"",cateId:"",img:"",imgs:[],status:"1",remark:"",skuType:"1",price:"",lineprice:"",amount:"",skus:{skus:[],specs:[]},content:""},editFormRules:{}}},methods:{getParamData(t,i){i=i||{};let r=t.currentTarget?t.currentTarget.dataset:t;return i&&(r=Object.assign(r,i)),r},navigateTo(t,i){let r=this.getParamData(t,i),{type:u}=r;u=="page"||u=="inner"||u=="href"?this.router.push({path:r.url,query:r}):typeof this[u]=="function"?this[u](r):y.error("待实现点击事件")},async init(){await this.catesApi()},async ordernumApi(t,i){t=t||{},t=this.getParamData(t);let r="/shop/goods/sortnum",u={},l={};if(u.id=t.id,!await this.confirmFunction({title:"确定置顶吗"})){y.error("你已取消");return}let f=await this.$http.post(r,u,l,"json");this.ordernum=f,this.resetQuery()},async updatenumApi(t,i){t=t||{},t=this.getParamData(t);let r="/shop/goods/update",u={},l={};if(u.id=t.id,u.sortnum=0,!await this.confirmFunction({title:"确定取消置顶吗"})){y.error("你已取消");return}let f=await this.$http.post(r,u,l,"json");this.updatenum=f,this.resetQuery()},async catesApi(t,i){t=t||{},t=this.getParamData(t);let r="/shop/cate/all",u={},l={},m=await this.$http.post(r,u,l,"json");this.cates=m},async confirmFunction(t){t=t||{};let i=this,r=t&&(t.title||t.title==0)?t.title:i.title||"";return new Promise(u=>{Q({message:r,title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{u(!0)}).catch(()=>{u(!1)})})},openDialog(t){t.id&&t.id!=null&&t.id!=0?this.editForm=se(t,this.editForm):this.initForm(),this.isShowDialog=!0,this.saveloading=!1},closeDialog(t){this.mittBus.emit("onEditAdmintableModule",t),this.isShowDialog=!1},onSubmit(){const t=this.$refs.editFormRef;t&&t.validate(i=>{i?(this.saveloading=!0,this.editForm.id!=null&&this.editForm.id!=0?ne("/shop/goods",this.editForm).then(()=>{y.success("修改成功"),this.saveloading=!1,this.closeDialog(this.editForm)}).finally(()=>{this.saveloading=!1}):ae("/shop/goods",this.editForm).then(()=>{y.success("新增成功"),this.saveloading=!1,this.closeDialog(this.editForm)}).finally(()=>{this.saveloading=!1})):y.error("验证未通过！")})},initForm(){this.editForm=F(this.editFormInit)},handleQuery(){this.loading=!0,re("/shop/goods",this.queryParams).then(t=>{this.tableData=t.rows,this.total=t.total,this.loading=!1})},resetQuery(){this.queryParams=F(this.queryParamsInit),this.handleQuery()},onOpenAddModule(t){t=[],this.title="添加商品",this.openDialog(t)},onOpenEditModule(t){this.title="修改商品",this.initForm(),this.openDialog(t)},onTabelRowDel(t){let i=this;const r=t.id||this.ids;Q({message:"是否确认删除选中的商品?",title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return de("/shop/goods",r).then(()=>{i.handleQuery(),y.success("删除成功")})})},handleSelectionChange(t){this.ids=t.map(i=>i.id),this.single=t.length!=1,this.multiple=!t.length},handleSizeChange(t){this.queryParams.pageSize=t,this.handleQuery()},handleCurrentChange(t){this.queryParams.pageNum=t,this.handleQuery()}},async mounted(){this.router=te(),this.globalOption=le().query;const t=ue(),{userInfos:i}=oe(t);this.userInfo=i,await this.init(),this.editFormInit=F(this.editForm),this.queryParamsInit=F(this.queryParams),this.handleQuery(),this.mittBus.on("onEditAdmintableModule",()=>{this.handleQuery()})},beforeUnmount(){this.mittBus.off("onEditAdmintableModule")}},C=t=>(ye("data-v-7c2d2b92"),t=t(),be(),t),ke={class:"container"},xe={class:"el-card is-always-shadow diygw-col-24"},ve={class:"el-card__body"},Fe={class:"mb8"},Ce={class:"flex diygw-col-0"},De={class:"flex diygw-col-0"},Ve={class:"mb8"},Se=["id"],Te={class:"flex diygw-col-24"},qe={class:"flex flex-direction-row flex-wrap"},Pe={class:"flex diygw-col-24"},Ie={class:"flex diygw-col-24"},Ue={class:"flex diygw-col-24"},Re={class:"flex diygw-col-24"},ze={class:"flex diygw-col-24"},Be={class:"flex diygw-col-24"},Ae={class:"flex flex-direction-row flex-wrap"},Qe={class:"flex diygw-col-24"},Ee={key:0,class:"flex flex-wrap diygw-col-24 flex-direction-column"},Me={class:"flex diygw-col-24"},je=C(()=>n("div",{class:"diygw-help-text"},"商品的实际购买金额，最低0.01",-1)),Ne={class:"flex diygw-col-24"},Oe=C(()=>n("div",{class:"diygw-help-text"},"划线价仅用于商品页展示",-1)),We={class:"flex diygw-col-24"},Le=C(()=>n("div",{class:"diygw-help-text"},"商品的实际库存数量，为0时用户无法下单",-1)),Xe={key:1,class:"flex diygw-col-24"},Ye={class:"flex flex-direction-row flex-wrap"},Ge={class:"flex diygw-col-24"},He={class:"dialog-footer flex justify-center"},Je=C(()=>n("div",{class:"clearfix"},null,-1));function Ke(t,i,r,u,l,m){const f=a("el-input"),p=a("el-form-item"),b=a("SvgIcon"),g=a("el-button"),P=a("el-form"),h=a("el-table-column"),x=a("el-tag"),v=a("diy-img"),E=a("el-table"),M=a("el-divider"),j=a("el-pagination"),N=a("FullScreen"),I=a("el-icon"),U=a("el-tooltip"),O=a("Remove"),W=a("el-option"),L=a("el-select"),X=a("diy-uploadinput"),Y=a("diy-photo"),R=a("el-radio"),z=a("el-radio-group"),D=a("el-tab-pane"),V=a("el-input-number"),G=a("diy-sku"),H=a("diy-editor"),J=a("el-tabs"),K=a("el-dialog"),Z=ge("loading");return c(),w("div",ke,[n("div",xe,[n("div",ve,[n("div",Fe,[e(P,{class:"flex flex-direction-row flex-wrap",model:l.queryParams,rules:l.queryParamsRules,ref:"queryForm","label-width":"80px"},{default:s(()=>[n("div",Ce,[e(p,{class:"diygw-el-rate",prop:"title_like",label:"标题"},{default:s(()=>[e(f,{type:"text",placeholder:"请输入标题查询",modelValue:l.queryParams.title_like,"onUpdate:modelValue":i[0]||(i[0]=o=>l.queryParams.title_like=o)},null,8,["modelValue"])]),_:1})]),n("div",De,[e(g,{type:"primary",onClick:m.handleQuery},{default:s(()=>[e(b,{name:"ele-Search"}),d(" 搜索 ")]),_:1},8,["onClick"]),d(),e(g,{onClick:m.resetQuery},{default:s(()=>[e(b,{name:"ele-Refresh"}),d(" 重置 ")]),_:1},8,["onClick"])])]),_:1},8,["model","rules"])]),n("div",Ve,[e(g,{type:"primary",plain:"",onClick:m.onOpenAddModule},{default:s(()=>[e(b,{name:"ele-Plus"}),d("新增 ")]),_:1},8,["onClick"]),d(),e(g,{type:"danger",plain:"",disabled:l.multiple,onClick:m.onTabelRowDel},{default:s(()=>[e(b,{name:"ele-Delete"}),d("删除 ")]),_:1},8,["disabled","onClick"])]),B((c(),_(E,{onSelectionChange:m.handleSelectionChange,data:l.tableData,stripe:"",border:"","current-row-key":"id","empty-text":"没有数据",style:{width:"100%"}},{default:s(()=>[e(h,{type:"selection",width:"55",align:"center"}),e(h,{label:"置顶",prop:"title",align:"center"},{default:s(o=>[o.row.sortnum>0?(c(),_(x,{key:0,style:{cursor:"pointer"},type:"error",onClick:k=>m.updatenumApi(o.row)},{default:s(()=>[d(" 取消置顶 ")]),_:2},1032,["onClick"])):(c(),_(x,{key:1,style:{cursor:"pointer"},onClick:k=>m.ordernumApi(o.row)},{default:s(()=>[d(" 置顶 ")]),_:2},1032,["onClick"]))]),_:1}),e(h,{label:"商品图片",prop:"img",align:"center"},{default:s(o=>[e(v,{style:{width:"80px",height:"80px"},src:o.row.img,fit:"contain"},null,8,["src"])]),_:1}),e(h,{label:"商品名称",prop:"title",align:"center"}),e(h,{label:"商品价格",prop:"price",align:"center"},{default:s(o=>[e(v,{style:{width:"80px",height:"80px"},src:o.row.price,fit:"contain"},null,8,["src"])]),_:1}),e(h,{label:"总销量",prop:"sellamonut",align:"center"},{default:s(o=>[e(v,{style:{width:"80px",height:"80px"},src:o.row.sellamonut,fit:"contain"},null,8,["src"])]),_:1}),e(h,{label:"库存量",prop:"amount",align:"center"},{default:s(o=>[e(v,{style:{width:"80px",height:"80px"},src:o.row.amount,fit:"contain"},null,8,["src"])]),_:1}),e(h,{label:"备注",prop:"remark",align:"center"}),e(h,{label:"数据状态",prop:"status",align:"center"},{default:s(o=>[o.row.status==1?(c(),_(x,{key:0},{default:s(()=>[d(" 有效 ")]),_:1})):(c(),_(x,{key:1},{default:s(()=>[d(" 无效 ")]),_:1}))]),_:1}),e(h,{label:"操作",align:"center",fixed:"right",width:"180"},{default:s(o=>[e(g,{type:"primary",plain:"",size:"small",onClick:k=>m.onOpenEditModule(o.row)},{default:s(()=>[e(b,{name:"ele-Edit"}),d("修改 ")]),_:2},1032,["onClick"]),d(),o.row.id!=0?(c(),_(g,{key:0,type:"danger",plain:"",size:"small",onClick:k=>m.onTabelRowDel(o.row)},{default:s(()=>[e(b,{name:"ele-Delete"}),d("删除 ")]),_:2},1032,["onClick"])):S("",!0)]),_:1})]),_:1},8,["onSelectionChange","data"])),[[Z,l.loading]]),B(n("div",null,[e(M),d(),e(j,{background:"",total:l.total,"current-page":l.queryParams.pageNum,"page-size":l.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:m.handleSizeChange,onCurrentChange:m.handleCurrentChange},null,8,["total","current-page","page-size","onSizeChange","onCurrentChange"])],512),[[he,l.total>0]])]),e(K,{fullscreen:l.isFullscreen,width:"800px",modelValue:l.isShowDialog,"onUpdate:modelValue":i[17]||(i[17]=o=>l.isShowDialog=o),"destroy-on-close":"",title:"商品",draggable:"",center:""},{header:s(({close:o,titleId:k,titleClass:$})=>[n("h4",{id:k,class:fe($)},"商品",10,Se),l.isFullscreen?S("",!0):(c(),_(U,{key:0,content:"最大化",placement:"bottom"},{default:s(()=>[e(g,{class:"diygw-max-icon el-dialog__headerbtn"},{default:s(()=>[e(I,{onClick:i[1]||(i[1]=ee=>l.isFullscreen=!l.isFullscreen)},{default:s(()=>[e(N)]),_:1})]),_:1})]),_:1})),l.isFullscreen?(c(),_(U,{key:1,content:"返回",placement:"bottom"},{default:s(()=>[e(g,{class:"diygw-max-icon el-dialog__headerbtn"},{default:s(()=>[e(I,{onClick:i[2]||(i[2]=ee=>l.isFullscreen=!l.isFullscreen)},{default:s(()=>[e(O)]),_:1})]),_:1})]),_:1})):S("",!0)]),footer:s(()=>[n("div",He,[e(g,{onClick:m.closeDialog},{default:s(()=>[d(" 取 消 ")]),_:1},8,["onClick"]),d(),e(g,{type:"primary",onClick:m.onSubmit,loading:l.saveloading},{default:s(()=>[d(" 保 存 ")]),_:1},8,["onClick","loading"])])]),default:s(()=>[e(P,{class:"flex flex-direction-row flex-wrap",model:l.editForm,rules:l.editFormRules,ref:"editFormRef","label-width":"120px"},{default:s(()=>[n("div",Te,[e(J,{modelValue:l.tabsTab,"onUpdate:modelValue":i[16]||(i[16]=o=>l.tabsTab=o),"tab-position":"top",onTabClick:t.handleClick},{default:s(()=>[e(D,{label:"基本信息",name:"1"},{default:s(()=>[n("div",qe,[n("div",Pe,[e(p,{rules:[{required:!0,trigger:"blur",message:"商品名称不能为空"}],class:"diygw-el-rate",prop:"title",label:"商品名称"},{default:s(()=>[e(f,{type:"text",placeholder:"请输入商品名称",modelValue:l.editForm.title,"onUpdate:modelValue":i[3]||(i[3]=o=>l.editForm.title=o)},null,8,["modelValue"])]),_:1})]),n("div",Ie,[e(p,{prop:"cateId",class:"diygw-el-rate",label:"商品分类"},{default:s(()=>[e(L,{"clear-icon":"CircleClose","suffix-icon":"ArrowUp",placeholder:"请选择",modelValue:l.editForm.cateId,"onUpdate:modelValue":i[4]||(i[4]=o=>l.editForm.cateId=o),style:{width:"100% !important"}},{default:s(()=>[(c(!0),w(T,null,q(l.cates.rows,o=>(c(),_(W,{key:o.id,label:o.title,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),n("div",Ue,[e(p,{rules:[{required:!0,trigger:"blur",message:"商品主图不能为空"}],prop:"img",class:"diygw-el-rate",label:"商品主图"},{default:s(()=>[e(X,{modelValue:l.editForm.img,"onUpdate:modelValue":i[5]||(i[5]=o=>l.editForm.img=o),title:"商品主图"},null,8,["modelValue"])]),_:1})]),n("div",Re,[e(p,{prop:"imgs",class:"diygw-el-rate",label:"商品轮播图"},{default:s(()=>[e(Y,{modelValue:l.editForm.imgs,"onUpdate:modelValue":i[6]||(i[6]=o=>l.editForm.imgs=o)},null,8,["modelValue"])]),_:1})]),n("div",ze,[e(p,{prop:"status",class:"diygw-el-rate",label:"商品状态"},{default:s(()=>[e(z,{modelValue:l.editForm.status,"onUpdate:modelValue":i[7]||(i[7]=o=>l.editForm.status=o)},{default:s(()=>[(c(!0),w(T,null,q(l.editFormData.statusDatas,o=>(c(),_(R,{key:o.value,label:o.value},{default:s(()=>[d(A(o.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),n("div",Be,[e(p,{prop:"remark",class:"diygw-el-rate",label:"商品描述"},{default:s(()=>[e(f,{type:"textarea",rows:"3",placeholder:"请输入描述",modelValue:l.editForm.remark,"onUpdate:modelValue":i[8]||(i[8]=o=>l.editForm.remark=o)},null,8,["modelValue"])]),_:1})])])]),_:1}),e(D,{label:"规格库存",name:"2"},{default:s(()=>[n("div",Ae,[n("div",Qe,[e(p,{prop:"skuType",class:"diygw-el-rate",label:"规格类型"},{default:s(()=>[e(z,{modelValue:l.editForm.skuType,"onUpdate:modelValue":i[9]||(i[9]=o=>l.editForm.skuType=o)},{default:s(()=>[(c(!0),w(T,null,q(l.editFormData.skuTypeDatas,o=>(c(),_(R,{key:o.value,label:o.value},{default:s(()=>[d(A(o.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),l.editForm.skuType==1?(c(),w("div",Ee,[n("div",Me,[e(p,{rules:[{type:"number",required:!0,trigger:"blur",message:"请输入数字"}],prop:"price",class:"diygw-el-rate",label:"商品价格"},{default:s(()=>[e(V,{min:"0",max:"100",step:"1",controls:"","controls-position":"right",placeholder:"输入商品价格",modelValue:l.editForm.price,"onUpdate:modelValue":i[10]||(i[10]=o=>l.editForm.price=o)},null,8,["modelValue"]),je]),_:1})]),n("div",Ne,[e(p,{rules:[{type:"number",required:!0,trigger:"blur",message:"请输入数字"}],prop:"lineprice",class:"diygw-el-rate",label:"切线价格"},{default:s(()=>[e(V,{min:"0",max:"100",step:"1",controls:"","controls-position":"right",placeholder:"输入切线价格",modelValue:l.editForm.lineprice,"onUpdate:modelValue":i[11]||(i[11]=o=>l.editForm.lineprice=o)},null,8,["modelValue"]),Oe]),_:1})]),n("div",We,[e(p,{rules:[{type:"number",required:!0,trigger:"blur",message:"请输入数字"}],prop:"amount",class:"diygw-el-rate",label:"库存数量"},{default:s(()=>[e(V,{min:"0",max:"100",step:"1",controls:"","controls-position":"right",placeholder:"输入库存数量",modelValue:l.editForm.amount,"onUpdate:modelValue":i[12]||(i[12]=o=>l.editForm.amount=o)},null,8,["modelValue"]),Le]),_:1})])])):(c(),w("div",Xe,[e(p,{prop:"skus",label:"多规格"},{default:s(()=>[e(G,{columns:l.editFormData.skusColumns,skus:l.editForm.skus.skus,"onUpdate:skus":i[13]||(i[13]=o=>l.editForm.skus.skus=o),specs:l.editForm.skus.specs,"onUpdate:specs":i[14]||(i[14]=o=>l.editForm.skus.specs=o)},null,8,["columns","skus","specs"])]),_:1})]))])]),_:1}),e(D,{label:"商品详情",name:"3"},{default:s(()=>[n("div",Ye,[n("div",Ge,[e(p,{rules:[{required:!0,trigger:"blur",message:"不能为空哟"}],prop:"content",class:"diygw-el-rate",label:"商品详情"},{default:s(()=>[e(H,{modelValue:l.editForm.content,"onUpdate:modelValue":i[15]||(i[15]=o=>l.editForm.content=o)},null,8,["modelValue"])]),_:1})])])]),_:1})]),_:1},8,["modelValue","onTabClick"])])]),_:1},8,["model","rules"])]),_:1},8,["fullscreen","modelValue"])]),Je])}const qt=ie(we,[["render",Ke],["__scopeId","data-v-7c2d2b92"]]);export{qt as default};
