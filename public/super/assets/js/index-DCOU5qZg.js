import{d as $,h as F,m as R,f as U,k as L,ag as n,aq as v,o as s,c as x,X as e,T as o,a8 as K,F as Q,p as A,S as m,W as i,U as _,v as W,x as X,e as j}from"./@vue-CRBWlwId.js";import{_ as z}from"./editModule.vue_vue_type_script_setup_true_lang-3pNlrH0U.js";import{l as G,m as H,k as J}from"./index-BfYElSN2.js";import{g as Y}from"./formatTime-Bwg9I4Gs.js";import{E as C,a as Z}from"./element-plus-C9Ov05af.js";import"./pinia-BTdriGDs.js";import"./vue-router-B8aOcPyE.js";import"./vue-i18n-Bpsr_IBC.js";import"./@intlify-Bn43FqoL.js";import"./vue-DEEPytDe.js";import"./js-cookie-Cz0CWeBA.js";import"./@element-plus-tztFf6PP.js";import"./nprogress-B-yuMcN-.js";import"./axios-Ds1py3KQ.js";import"./lodash-CnNYTNB6.js";import"./mitt-DJ65BbbF.js";import"./file-saver-B2L8jjWN.js";import"./diygw-datav-DLF-c6uN.js";import"./lodash-es-CW97kIZl.js";import"./@vueuse-BIgT8fdk.js";import"./@popperjs-CER6Qr1e.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-r8A8W4xn.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-DwF5HINA.js";import"./escape-html-HzfLCvW4.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DuJrlvqV.js";const ee={class:"container"},Ne=$({__name:"index",setup(te){const{proxy:f}=j(),h=F(),t=R({loading:!0,title:"",tableData:[],statusOptions:[],queryParams:{deptName:void 0,status:void 0}}),u=()=>{t.loading=!0,G("/sys/dept",t.queryParams).then(a=>{t.tableData=H(a.rows,"deptId","parentId","children"),t.loading=!1})},k=()=>{t.queryParams.deptName=void 0,t.queryParams.status=void 0,u()},D=a=>f.selectDictLabel(t.statusOptions,a.status),b=a=>{let r=a.deptId;a=[],a.parentId=r,t.title="添加部门",h.value.openDialog(a)},q=a=>{t.title="修改部门",h.value.openDialog(a)},P=a=>{C({message:'是否确认删除名称为"'+a.deptName+'"的数据项?',title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return J("/sys/dept",a.deptId).then(()=>{u(),Z.success("删除成功")})})},B=()=>{const a=t.queryParams;C({message:"是否确认导出所有部门数据项?",title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){let r=Y();f.download("/sys/dept/export",a,`部门_${r}.xlsx`)})};return U(()=>{u(),f.getDicts("sys_normal_disable").then(a=>{t.statusOptions=a.rows}),f.mittBus.on("onEditDeptModule",a=>{u()})}),L(()=>{f.mittBus.off("onEditDeptModule")}),(a,r)=>{const I=n("el-input"),g=n("el-form-item"),N=n("el-option"),V=n("el-select"),d=n("SvgIcon"),p=n("el-button"),T=n("el-form"),c=n("el-table-column"),E=n("el-tag"),M=n("el-table"),O=n("el-card"),y=v("auth"),S=v("loading");return s(),x("div",ee,[e(O,{shadow:"always"},{default:o(()=>[e(T,{model:t.queryParams,ref:"queryForm",inline:!0,"label-width":"68px"},{default:o(()=>[e(g,{label:"部门名称",prop:"deptName"},{default:o(()=>[e(I,{placeholder:"请输入部门名称模糊查询",clearable:"",onKeyup:K(u,["enter","native"]),modelValue:t.queryParams.deptName,"onUpdate:modelValue":r[0]||(r[0]=l=>t.queryParams.deptName=l)},null,8,["modelValue"])]),_:1}),e(g,{label:"状态",prop:"status"},{default:o(()=>[e(V,{modelValue:t.queryParams.status,"onUpdate:modelValue":r[1]||(r[1]=l=>t.queryParams.status=l),placeholder:"部门状态",clearable:""},{default:o(()=>[(s(!0),x(Q,null,A(t.statusOptions,l=>(s(),m(N,{key:l.dictValue,label:l.dictLabel,value:l.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(g,null,{default:o(()=>[e(p,{type:"primary",onClick:u},{default:o(()=>[e(d,{name:"ele-Search"}),i(" 搜索 ")]),_:1}),e(p,{onClick:k},{default:o(()=>[e(d,{name:"ele-Refresh"}),i(" 重置 ")]),_:1}),_((s(),m(p,{type:"primary",plain:"",onClick:b},{default:o(()=>[e(d,{name:"ele-Plus"}),i(" 新增 ")]),_:1})),[[y,"system:dept:add"]]),_((s(),m(p,{type:"warning",plain:"",onClick:B},{default:o(()=>[e(d,{name:"ele-Download"}),i("导出 ")]),_:1})),[[y,"system:dept:add"]])]),_:1})]),_:1},8,["model"]),_((s(),m(M,{data:t.tableData,"row-key":"deptId",border:"","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"}},{default:o(()=>[e(c,{prop:"deptName",label:"部门名称",width:"260"}),e(c,{prop:"createTime",label:"创建时间",width:"300"}),e(c,{prop:"orderNum",label:"排序",width:"200"}),e(c,{prop:"status",label:"状态",width:"100"},{default:o(l=>[e(E,{type:l.row.status==="1"?"danger":"success","disable-transitions":""},{default:o(()=>[i(W(D(l.row)),1)]),_:2},1032,["type"])]),_:1}),e(c,{label:"负责人",align:"center",prop:"leader",width:"200"}),e(c,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:o(l=>[_((s(),m(p,{type:"text",onClick:w=>q(l.row)},{default:o(()=>[e(d,{name:"ele-Edit"}),i("修改 ")]),_:2},1032,["onClick"])),[[y,"system:dept:edit"]]),_((s(),m(p,{type:"text",onClick:w=>b(l.row)},{default:o(()=>[e(d,{name:"ele-Plus"}),i("新增 ")]),_:2},1032,["onClick"])),[[y,"system:dept:add"]]),l.row.parentId!=0?_((s(),m(p,{key:0,type:"text",onClick:w=>P(l.row)},{default:o(()=>[e(d,{name:"ele-Delete"}),i("删除 ")]),_:2},1032,["onClick"])),[[y,"system:dept:delete"]]):X("",!0)]),_:1})]),_:1},8,["data"])),[[S,t.loading]])]),_:1}),e(z,{ref_key:"editModuleRef",ref:h,title:t.title},null,8,["title"])])}}});export{Ne as default};
