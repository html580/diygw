import{b as x,u as v}from"./vue-router-B8aOcPyE.js";import{s as w}from"./pinia-BTdriGDs.js";import{_ as b,p as V,c as k}from"./index-BfYElSN2.js";import{D as I}from"./uploadinput-CMX3D0tT.js";import{a as u}from"./element-plus-C9Ov05af.js";import{ag as n,o as F,c as T,X as s,T as p,a as r,W as f,bn as U,bl as R}from"./@vue-CRBWlwId.js";import"./vue-i18n-Bpsr_IBC.js";import"./@intlify-Bn43FqoL.js";import"./vue-DEEPytDe.js";import"./js-cookie-Cz0CWeBA.js";import"./@element-plus-tztFf6PP.js";import"./nprogress-B-yuMcN-.js";import"./axios-Ds1py3KQ.js";import"./lodash-CnNYTNB6.js";import"./mitt-DJ65BbbF.js";import"./file-saver-B2L8jjWN.js";import"./diygw-datav-DLF-c6uN.js";import"./lodash-es-CW97kIZl.js";import"./@vueuse-BIgT8fdk.js";import"./@popperjs-CER6Qr1e.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-r8A8W4xn.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-DwF5HINA.js";import"./escape-html-HzfLCvW4.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DuJrlvqV.js";const D={components:{DiyUploadinput:I},data(){return{globalOption:{},userInfo:{},data:{code:0,msg:"",data:{id:0,title:null,value:"",key:"",sortnum:0,status:"",userId:0,createTime:"",updateTime:"",deleteTime:null}},saveFormLoading:!1,form:{appid:"",secret:"",pay_mch_id:"",pay_signature:"",cert_path:"",cert_key:""}}},methods:{getParamData(o,e){e=e||{};let l=o.currentTarget?o.currentTarget.dataset:o;return e&&(l=Object.assign(l,e)),l},navigateTo(o,e){let l=this.getParamData(o,e),{type:a}=l;a=="page"||a=="inner"||a=="href"?this.router.push({path:l.url,query:l}):typeof this[a]=="function"?this[a](l):u.error("待实现点击事件")},async init(){await this.dataApi()},async dataApi(o){o=o||{},o=this.getParamData(o);let e="/shop/setting/get",l={key:o.key||"wechat"},a={},t=await this.$http.post(e,l,a,"json");this.data=t,t.data&&(this.form=JSON.parse(t.data.value))},submitForm(){this.$refs.formRef&&this.$refs.formRef.validate((o,e)=>{if(o){this.saveFormLoading=!0;let l=this.form,a="/shop/setting/add",t={key:"wechat",value:l};t.title="微信配置",V(a,t).then(m=>{u.success(m.msg||"保存成功"),this.saveFormLoading=!1}).finally(()=>{this.saveFormLoading=!1})}else{let l="";e&&Object.keys(e).length>0&&(l=e[Object.keys(e)[0]].map(m=>m.message).join(",")),u.error("验证未通过！"+l),console.log("error submit!",e)}})},resetForm(){this.$refs.formRef&&this.$refs.formRef.resetFields()}},async mounted(){this.router=x(),this.globalOption=v().query;const o=k(),{userInfos:e}=w(o);this.userInfo=e,await this.init()},beforeUnmount(){}},_=o=>(U("data-v-daa909f6"),o=o(),R(),o),j={class:"container"},C={class:"flex diygw-col-24"},O={class:"flex diygw-col-24"},P={class:"flex diygw-col-24"},L={class:"flex diygw-col-24"},N={class:"flex diygw-col-24"},S=_(()=>r("div",{class:"diygw-help-text"},"微信支付证书（apiclient_cert.pem），前往微信商家平台下载，文件名一般为apiclient_cert.pem",-1)),A={class:"flex diygw-col-24"},B=_(()=>r("div",{class:"diygw-help-text"},"微信支付证书密钥（apiclient_key.pem），前往微信商家平台下载。文件名一般为apiclient_key.pem",-1)),q={class:"padding-xs flex diygw-col-24 justify-center"},E=_(()=>r("div",{class:"clearfix"},null,-1));function J(o,e,l,a,t,m){const c=n("el-input"),d=n("el-form-item"),h=n("diy-uploadinput"),y=n("el-button"),g=n("el-form");return F(),T("div",j,[s(g,{ref:"formRef",model:t.form,"label-width":"150px","label-postition":"right",class:"flex flex-wrap diygw-col-24"},{default:p(()=>[r("div",C,[s(d,{class:"diygw-el-rate",prop:"appid",label:"小程序APPID"},{default:p(()=>[s(c,{type:"text",placeholder:"请输入小程序appid",modelValue:t.form.appid,"onUpdate:modelValue":e[0]||(e[0]=i=>t.form.appid=i)},null,8,["modelValue"])]),_:1})]),r("div",O,[s(d,{class:"diygw-el-rate",prop:"secret",label:"小程序密钥"},{default:p(()=>[s(c,{type:"text",placeholder:"请输入小程序secret",modelValue:t.form.secret,"onUpdate:modelValue":e[1]||(e[1]=i=>t.form.secret=i)},null,8,["modelValue"])]),_:1})]),r("div",P,[s(d,{class:"diygw-el-rate",prop:"pay_mch_id",label:"商户号"},{default:p(()=>[s(c,{type:"text",placeholder:"请输入小程序mch_id",modelValue:t.form.pay_mch_id,"onUpdate:modelValue":e[2]||(e[2]=i=>t.form.pay_mch_id=i)},null,8,["modelValue"])]),_:1})]),r("div",L,[s(d,{class:"diygw-el-rate",prop:"pay_signature",label:"支付密钥"},{default:p(()=>[s(c,{type:"text",placeholder:"支付signature",modelValue:t.form.pay_signature,"onUpdate:modelValue":e[3]||(e[3]=i=>t.form.pay_signature=i)},null,8,["modelValue"])]),_:1})]),r("div",N,[s(d,{prop:"cert_path",class:"diygw-el-rate",local:"1",label:"支付证书"},{default:p(()=>[s(h,{local:"1",type:"file",accept:".pem",modelValue:t.form.cert_path,"onUpdate:modelValue":e[4]||(e[4]=i=>t.form.cert_path=i),title:"支付证书"},null,8,["modelValue"]),S]),_:1})]),r("div",A,[s(d,{prop:"cert_key",class:"diygw-el-rate",local:"1",label:"支付证书密钥"},{default:p(()=>[s(h,{local:"1",type:"file",accept:".pem",modelValue:t.form.cert_key,"onUpdate:modelValue":e[5]||(e[5]=i=>t.form.cert_key=i),title:"支付证书密钥"},null,8,["modelValue"]),B]),_:1})]),r("div",q,[s(y,{onClick:m.submitForm,type:"primary",class:"margin-xs"},{default:p(()=>[f(" 提交 ")]),_:1},8,["onClick"]),f(),s(y,{onClick:m.resetForm,type:"danger",class:"margin-xs"},{default:p(()=>[f(" 重置 ")]),_:1},8,["onClick"])])]),_:1},8,["model"]),E])}const he=b(D,[["render",J],["__scopeId","data-v-daa909f6"]]);export{he as default};
