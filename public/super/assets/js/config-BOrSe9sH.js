import{b as W,u as L}from"./vue-router-B8aOcPyE.js";import{s as X}from"./pinia-BTdriGDs.js";import{_ as Y,g as G,h as H,i as K,j as F,l as Z,k as $,c as ee}from"./index-BfYElSN2.js";import{t as te}from"./vue-draggable-plus-D90yCKwz.js";import{ag as r,aq as le,o as p,c as x,a as n,X as l,T as a,W as s,U as I,S as y,x as w,Y as ie,q as ae,Q as oe,F as P,p as q,v as se,bn as ne,bl as re}from"./@vue-CRBWlwId.js";import{a as g,E as z}from"./element-plus-C9Ov05af.js";import"./vue-i18n-Bpsr_IBC.js";import"./@intlify-Bn43FqoL.js";import"./vue-DEEPytDe.js";import"./js-cookie-Cz0CWeBA.js";import"./@element-plus-tztFf6PP.js";import"./nprogress-B-yuMcN-.js";import"./axios-Ds1py3KQ.js";import"./lodash-CnNYTNB6.js";import"./mitt-DJ65BbbF.js";import"./file-saver-B2L8jjWN.js";import"./diygw-datav-DLF-c6uN.js";import"./lodash-es-CW97kIZl.js";import"./@vueuse-BIgT8fdk.js";import"./@popperjs-CER6Qr1e.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-r8A8W4xn.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-DwF5HINA.js";import"./escape-html-HzfLCvW4.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DuJrlvqV.js";const de={components:{VueDraggable:te},data(){return{globalOption:{},userInfo:{},ordernum:{code:200,msg:"设置成功"},updatenum:{code:200,msg:"修改成功",data:{id:"1",sortnum:"0"}},loading:!0,ids:[],single:!0,multiple:!0,title:"",total:0,tableData:[],isFullscreen:!1,isShowDialog:!1,saveloading:!1,editFormInit:{},queryParamsInit:{},valueItem:{},editFormData:{radioDatas:[{value:"1",label:"有效"},{value:"2",label:"无效"}]},queryParams:{pageNum:1,pageSize:10,title_like:""},queryParamsRules:{},editForm:{id:void 0,key:"",input:"",title:"",min:"",inputnumber:"",value:[],radio:"1"},editFormRules:{}}},methods:{getParamData(e,t){t=t||{};let u=e.currentTarget?e.currentTarget.dataset:e;return t&&(u=Object.assign(u,t)),u},navigateTo(e,t){let u=this.getParamData(e,t),{type:m}=u;m=="page"||m=="inner"||m=="href"?this.router.push({path:u.url,query:u}):typeof this[m]=="function"?this[m](u):g.error("待实现点击事件")},async init(){},async ordernumApi(e,t){e=e||{},e=this.getParamData(e);let u="/fang/configPrice/sortnum",m={},i={};if(m.id=e.id,!await this.confirmFunction({title:"确定置顶吗"})){g.error("你已取消");return}let f=await this.$http.post(u,m,i,"json");this.ordernum=f,this.resetQuery()},async updatenumApi(e,t){e=e||{},e=this.getParamData(e);let u="/fang/configPrice/update",m={},i={};if(m.id=e.id,m.sortnum=0,!await this.confirmFunction({title:"确定取消置顶吗"})){g.error("你已取消");return}let f=await this.$http.post(u,m,i,"json");this.updatenum=f,this.resetQuery()},async confirmFunction(e){e=e||{};let t=this,u=e&&(e.title||e.title==0)?e.title:t.title||"";return new Promise(m=>{z({message:u,title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{m(!0)}).catch(()=>{m(!1)})})},initValueData(){for(let e=0;e<1;e++)this.editForm.value.push(JSON.parse(JSON.stringify(this.valueItem)))},upValueItem(e){let{index:t}=e.currentTarget.dataset;if(t==0)return g.error("已经是第一个"),!1;this.editForm.value[t]=this.editForm.value.splice(t-1,1,this.editForm.value[t])[0]},downValueItem(e){let{index:t}=e.currentTarget.dataset;if(t==this.editForm.value.length-1)return g.error("已经是最后一个"),!1;this.editForm.value[t]=this.editForm.value.splice(t+1,1,this.editForm.value[t])[0]},delValueItem(e){let{index:t}=e.currentTarget.dataset;this.editForm.value.splice(t,1)},addValueItem(){this.editForm.value.push(JSON.parse(JSON.stringify(this.valueItem)))},openDialog(e){e.id&&e.id!=null&&e.id!=0?this.editForm=G(e,this.editForm):this.initForm(),this.isShowDialog=!0,this.saveloading=!1},closeDialog(e){this.mittBus.emit("onEditAdmintableModule",e),this.isShowDialog=!1},onSubmit(){const e=this.$refs.editFormRef;e&&e.validate(t=>{t?(this.saveloading=!0,this.editForm.id!=null&&this.editForm.id!=0?H("/fang/config",this.editForm).then(()=>{g.success("修改成功"),this.saveloading=!1,this.closeDialog(this.editForm)}).finally(()=>{this.saveloading=!1}):K("/fang/config",this.editForm).then(()=>{g.success("新增成功"),this.saveloading=!1,this.closeDialog(this.editForm)}).finally(()=>{this.saveloading=!1})):g.error("验证未通过！")})},initForm(){this.editForm=F(this.editFormInit)},handleQuery(){this.loading=!0,Z("/fang/config",this.queryParams).then(e=>{this.tableData=e.rows,this.total=e.total,this.loading=!1})},resetQuery(){this.queryParams=F(this.queryParamsInit),this.handleQuery()},onOpenAddModule(e){e=[],this.title="添加搜索价格",this.openDialog(e)},onOpenEditModule(e){this.title="修改搜索价格",this.initForm(),this.openDialog(e)},onTabelRowDel(e){let t=this;const u=e.id||this.ids;z({message:"是否确认删除选中的搜索价格?",title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return $("/fang/config",u).then(()=>{t.handleQuery(),g.success("删除成功")})})},handleSelectionChange(e){this.ids=e.map(t=>t.id),this.single=e.length!=1,this.multiple=!e.length},handleSizeChange(e){this.queryParams.pageSize=e,this.handleQuery()},handleCurrentChange(e){this.queryParams.pageNum=e,this.handleQuery()}},async mounted(){this.router=W(),this.globalOption=L().query;const e=ee(),{userInfos:t}=X(e);this.userInfo=t,await this.init(),this.initValueData(),this.editFormInit=F(this.editForm),this.queryParamsInit=F(this.queryParams),this.handleQuery(),this.mittBus.on("onEditAdmintableModule",()=>{this.handleQuery()})},beforeUnmount(){this.mittBus.off("onEditAdmintableModule")}},ue=e=>(ne("data-v-46dc65f6"),e=e(),re(),e),me={class:"container"},ce={class:"el-card is-always-shadow diygw-col-24"},pe={class:"el-card__body"},he={class:"mb8"},ge={class:"flex diygw-col-0"},fe={class:"flex diygw-col-0"},_e={class:"mb8"},ye=["id"],ve={class:"flex diygw-col-12"},be={class:"flex diygw-col-12"},Fe={class:"flex diygw-col-0"},xe={class:"flex diygw-col-0"},we={class:"flex diygw-col-0"},Ce={class:"flex flex-wrap diygw-col-24 flex-direction-column"},ke=["model"],Ve={class:"padding-xs flex diygw-col-24 justify-end"},De={class:"padding-xs justify-end flex diygw-col-24"},Se={class:"flex diygw-col-12"},Ie={class:"dialog-footer flex justify-center"},Pe=ue(()=>n("div",{class:"clearfix"},null,-1));function qe(e,t,u,m,i,d){const f=r("el-input"),_=r("el-form-item"),v=r("SvgIcon"),c=r("el-button"),C=r("el-form"),b=r("el-table-column"),k=r("el-tag"),T=r("el-table"),R=r("el-divider"),B=r("el-pagination"),Q=r("FullScreen"),V=r("el-icon"),D=r("el-tooltip"),U=r("Remove"),S=r("el-input-number"),N=r("vue-draggable"),O=r("el-radio"),E=r("el-radio-group"),M=r("el-dialog"),j=le("loading");return p(),x("div",me,[n("div",ce,[n("div",pe,[n("div",he,[l(C,{class:"flex flex-direction-row flex-wrap",model:i.queryParams,rules:i.queryParamsRules,ref:"queryForm","label-width":"80px"},{default:a(()=>[n("div",ge,[l(_,{class:"diygw-el-rate",prop:"title_like",label:"名称"},{default:a(()=>[l(f,{type:"text",placeholder:"请输入名称查询",modelValue:i.queryParams.title_like,"onUpdate:modelValue":t[0]||(t[0]=o=>i.queryParams.title_like=o)},null,8,["modelValue"])]),_:1})]),n("div",fe,[l(c,{type:"primary",onClick:d.handleQuery},{default:a(()=>[l(v,{name:"ele-Search"}),s(" 搜索 ")]),_:1},8,["onClick"]),s(),l(c,{onClick:d.resetQuery},{default:a(()=>[l(v,{name:"ele-Refresh"}),s(" 重置 ")]),_:1},8,["onClick"])])]),_:1},8,["model","rules"])]),n("div",_e,[l(c,{type:"primary",plain:"",onClick:d.onOpenAddModule},{default:a(()=>[l(v,{name:"ele-Plus"}),s("新增 ")]),_:1},8,["onClick"]),s(),l(c,{type:"danger",plain:"",disabled:i.multiple,onClick:d.onTabelRowDel},{default:a(()=>[l(v,{name:"ele-Delete"}),s("删除 ")]),_:1},8,["disabled","onClick"])]),I((p(),y(T,{onSelectionChange:d.handleSelectionChange,data:i.tableData,stripe:"",border:"","current-row-key":"id","empty-text":"没有数据",style:{width:"100%"}},{default:a(()=>[l(b,{type:"selection",width:"55",align:"center"}),l(b,{label:"关键词",prop:"key",align:"center"}),l(b,{label:"名称",prop:"title",align:"center"}),l(b,{label:"数据状态",prop:"status",align:"center"},{default:a(o=>[o.row.status==1?(p(),y(k,{key:0},{default:a(()=>[s(" 有效 ")]),_:1})):(p(),y(k,{key:1},{default:a(()=>[s(" 无效 ")]),_:1}))]),_:1}),l(b,{label:"操作",align:"center",fixed:"right",width:"180"},{default:a(o=>[l(c,{type:"primary",plain:"",size:"small",onClick:h=>d.onOpenEditModule(o.row)},{default:a(()=>[l(v,{name:"ele-Edit"}),s("修改 ")]),_:2},1032,["onClick"]),s(),o.row.id!=0?(p(),y(c,{key:0,type:"danger",plain:"",size:"small",onClick:h=>d.onTabelRowDel(o.row)},{default:a(()=>[l(v,{name:"ele-Delete"}),s("删除 ")]),_:2},1032,["onClick"])):w("",!0)]),_:1})]),_:1},8,["onSelectionChange","data"])),[[j,i.loading]]),I(n("div",null,[l(R),s(),l(B,{background:"",total:i.total,"current-page":i.queryParams.pageNum,"page-size":i.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:d.handleSizeChange,onCurrentChange:d.handleCurrentChange},null,8,["total","current-page","page-size","onSizeChange","onCurrentChange"])],512),[[ie,i.total>0]])]),l(M,{fullscreen:i.isFullscreen,width:"800px",modelValue:i.isShowDialog,"onUpdate:modelValue":t[10]||(t[10]=o=>i.isShowDialog=o),"destroy-on-close":"",title:"搜索价格",draggable:"",center:""},{header:a(({close:o,titleId:h,titleClass:A})=>[n("h4",{id:h,class:ae(A)},"搜索价格",10,ye),i.isFullscreen?w("",!0):(p(),y(D,{key:0,content:"最大化",placement:"bottom"},{default:a(()=>[l(c,{class:"diygw-max-icon el-dialog__headerbtn"},{default:a(()=>[l(V,{onClick:t[1]||(t[1]=J=>i.isFullscreen=!i.isFullscreen)},{default:a(()=>[l(Q)]),_:1})]),_:1})]),_:1})),i.isFullscreen?(p(),y(D,{key:1,content:"返回",placement:"bottom"},{default:a(()=>[l(c,{class:"diygw-max-icon el-dialog__headerbtn"},{default:a(()=>[l(V,{onClick:t[2]||(t[2]=J=>i.isFullscreen=!i.isFullscreen)},{default:a(()=>[l(U)]),_:1})]),_:1})]),_:1})):w("",!0)]),footer:a(()=>[n("div",Ie,[l(c,{onClick:d.closeDialog},{default:a(()=>[s(" 取 消 ")]),_:1},8,["onClick"]),s(),l(c,{type:"primary",onClick:d.onSubmit,loading:i.saveloading},{default:a(()=>[s(" 保 存 ")]),_:1},8,["onClick","loading"])])]),default:a(()=>[l(C,{class:"flex flex-direction-row flex-wrap",model:i.editForm,rules:i.editFormRules,ref:"editFormRef","label-width":"120px"},{default:a(()=>[n("div",ve,[l(_,{rules:[{required:!0,trigger:"blur",message:"不能为空哟"}],class:"diygw-el-rate",prop:"key",label:"关键词"},{default:a(()=>[l(f,{type:"text",placeholder:"请输入关键词",modelValue:i.editForm.key,"onUpdate:modelValue":t[3]||(t[3]=o=>i.editForm.key=o)},null,8,["modelValue"])]),_:1})]),n("div",be,[l(_,{rules:[{required:!0,trigger:"blur",message:"不能为空哟"}],class:"diygw-el-rate",prop:"input",label:"名称"},{default:a(()=>[l(f,{type:"text",placeholder:"请输入名称",modelValue:i.editForm.input,"onUpdate:modelValue":t[4]||(t[4]=o=>i.editForm.input=o)},null,8,["modelValue"])]),_:1})]),n("div",Fe,[l(_,{rules:[{required:!0,trigger:"blur",message:"显示名称不能为空"}],class:"diygw-el-rate",prop:"title","label-width":"0px"},{default:a(()=>[l(f,{type:"text",placeholder:"请输入显示名称",modelValue:i.editForm.title,"onUpdate:modelValue":t[5]||(t[5]=o=>i.editForm.title=o)},null,8,["modelValue"])]),_:1})]),n("div",xe,[l(_,{prop:"min",class:"diygw-el-rate","label-width":"0px"},{default:a(()=>[l(S,{min:"0",max:"100",step:"1",controls:"",placeholder:"输入最小值",modelValue:i.editForm.min,"onUpdate:modelValue":t[6]||(t[6]=o=>i.editForm.min=o)},null,8,["modelValue"])]),_:1})]),n("div",we,[l(_,{prop:"inputnumber",class:"diygw-el-rate","label-width":"0px"},{default:a(()=>[l(S,{min:"0",max:"100",step:"1",controls:"",placeholder:"输入最大值",modelValue:i.editForm.inputnumber,"onUpdate:modelValue":t[7]||(t[7]=o=>i.editForm.inputnumber=o)},null,8,["modelValue"])]),_:1})]),n("div",Ce,[l(N,oe({tag:"transition-group"},{animation:200,disabled:!1,ghostClass:"ghost"},{modelValue:i.editForm.value,"onUpdate:modelValue":t[8]||(t[8]=o=>i.editForm.value=o),group:"value",handle:".handle","item-key":"id"}),{default:a(()=>[(p(!0),x(P,null,q(i.editForm.value,(o,h)=>(p(),x("div",null,[n("div",{model:i.editForm.value[h],errorType:["message","toast"]},null,8,ke),n("div",Ve,[l(c,{size:"small",type:"primary",class:"handle radius margin-xs"},{default:a(()=>[s(" 拖动 ")]),_:1}),s(),l(c,{size:"small",onClick:d.upValueItem,"data-index":h,type:"primary",class:"radius margin-xs"},{default:a(()=>[s(" 上移 ")]),_:2},1032,["onClick","data-index"]),s(),l(c,{size:"small",onClick:d.downValueItem,"data-index":h,type:"primary",class:"radius margin-xs"},{default:a(()=>[s(" 下移 ")]),_:2},1032,["onClick","data-index"]),l(c,{size:"small",onClick:d.delValueItem,"data-index":h,type:"danger",class:"radius margin-xs"},{default:a(()=>[s(" 删除 ")]),_:2},1032,["onClick","data-index"]),s(),l(c,{size:"small",onClick:d.addValueItem,"data-index":h,type:"primary",class:"radius margin-xs"},{default:a(()=>[s(" 新增 ")]),_:2},1032,["onClick","data-index"])])]))),256))]),_:1},16,["modelValue"]),n("div",De,[l(c,{size:"small",onClick:d.addValueItem,type:"primary",class:"radius margin-xs"},{default:a(()=>[s(" 新增 ")]),_:1},8,["onClick"])])]),n("div",Se,[l(_,{prop:"radio",class:"diygw-el-rate",label:"数据状态"},{default:a(()=>[l(E,{modelValue:i.editForm.radio,"onUpdate:modelValue":t[9]||(t[9]=o=>i.editForm.radio=o)},{default:a(()=>[(p(!0),x(P,null,q(i.editFormData.radioDatas,o=>(p(),y(O,{key:o.value,label:o.value},{default:a(()=>[s(se(o.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),_:1},8,["model","rules"])]),_:1},8,["fullscreen","modelValue"])]),Pe])}const ot=Y(de,[["render",qe],["__scopeId","data-v-46dc65f6"]]);export{ot as default};
