import{d as Y,h as A,m as G,f as H,ag as r,aq as V,o as c,c as q,X as e,T as o,a8 as P,F as J,p as Z,S as f,W as s,U as b,v as i,Y as ee,a as D,x as te,e as oe}from"./@vue-CRBWlwId.js";import{l as ae,w as le,k as ne}from"./index-BfYElSN2.js";import{E as T,a as k}from"./element-plus-C9Ov05af.js";import"./pinia-BTdriGDs.js";import"./vue-router-B8aOcPyE.js";import"./vue-i18n-Bpsr_IBC.js";import"./@intlify-Bn43FqoL.js";import"./vue-DEEPytDe.js";import"./js-cookie-Cz0CWeBA.js";import"./@element-plus-tztFf6PP.js";import"./nprogress-B-yuMcN-.js";import"./axios-Ds1py3KQ.js";import"./lodash-CnNYTNB6.js";import"./mitt-DJ65BbbF.js";import"./file-saver-B2L8jjWN.js";import"./diygw-datav-DLF-c6uN.js";import"./lodash-es-CW97kIZl.js";import"./@vueuse-BIgT8fdk.js";import"./@popperjs-CER6Qr1e.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-r8A8W4xn.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-DwF5HINA.js";import"./escape-html-HzfLCvW4.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DuJrlvqV.js";const re={class:"system-user-container container"},se={class:"dialog-footer"},Oe=Y({__name:"index",setup(pe){const{proxy:y}=oe(),N=A(null),t=G({loading:!0,total:0,tableData:[],ids:[],single:!0,multiple:!0,title:"",open:!1,modelForm:{},typeOptions:[],statusOptions:[],queryParams:{pageNum:1,pageSize:10,title:void 0,operName:void 0,businessType:void 0}}),u=()=>{t.loading=!0,ae("/log/operations",t.queryParams).then(a=>{t.tableData=a.rows,t.total=a.total,t.loading=!1})},S=()=>{t.queryParams.title=void 0,t.queryParams.operName=void 0,t.queryParams.businessType=void 0,u()},B=()=>{T({message:"是否确认清空所有操作日志数据项?",title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return le("/log/operations")}).then(()=>{u(),k.success("清空成功")})},z=a=>{const n=a.operId||t.ids;T({message:'是否确认删除日志编号为"'+n+'"的数据项?',title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return ne("/log/operations",n).then(()=>{u(),k.success("删除成功")})})},I=a=>{t.open=!0,t.modelForm=a},O=a=>{t.queryParams.pageSize=a,u()},L=a=>{t.queryParams.pageNum=a,u()},h=a=>y.selectDictLabel(t.statusOptions,a.status),w=(a,n)=>y.selectDictLabel(t.typeOptions,a.businessType),U=a=>{t.ids=a.map(n=>n.operId),t.single=a.length!=1,t.multiple=!a.length};return H(()=>{u(),y.getDicts("sys_common_status").then(a=>{t.statusOptions=a.rows}),y.getDicts("sys_oper_type").then(a=>{t.typeOptions=a.rows})}),(a,n)=>{const v=r("el-input"),p=r("el-form-item"),E=r("el-option"),M=r("el-select"),g=r("SvgIcon"),_=r("el-button"),C=r("el-form"),d=r("el-col"),F=r("el-row"),m=r("el-table-column"),R=r("el-tag"),K=r("el-table"),Q=r("el-divider"),$=r("el-pagination"),j=r("el-card"),W=r("el-dialog"),x=V("auth"),X=V("loading");return c(),q("div",re,[e(j,{shadow:"always"},{default:o(()=>[e(C,{model:t.queryParams,ref:"queryForm",inline:!0,"label-width":"68px"},{default:o(()=>[e(p,{label:"系统模块",prop:"title"},{default:o(()=>[e(v,{placeholder:"请输入系统模块模糊查询",clearable:"",onKeyup:P(u,["enter"]),style:{width:"240px"},modelValue:t.queryParams.title,"onUpdate:modelValue":n[0]||(n[0]=l=>t.queryParams.title=l)},null,8,["modelValue"])]),_:1}),e(p,{label:"操作人员",prop:"operName"},{default:o(()=>[e(v,{placeholder:"请输入操作人员模糊查询",clearable:"",onKeyup:P(u,["enter"]),style:{width:"240px"},modelValue:t.queryParams.operName,"onUpdate:modelValue":n[1]||(n[1]=l=>t.queryParams.operName=l)},null,8,["modelValue"])]),_:1}),e(p,{label:"类型",prop:"businessType"},{default:o(()=>[e(M,{modelValue:t.queryParams.businessType,"onUpdate:modelValue":n[2]||(n[2]=l=>t.queryParams.businessType=l),placeholder:"操作类型",clearable:"",style:{width:"240px"}},{default:o(()=>[(c(!0),q(J,null,Z(t.typeOptions,l=>(c(),f(E,{key:l.dictValue,label:l.dictLabel,value:l.dictValue},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,null,{default:o(()=>[e(_,{type:"primary",onClick:u},{default:o(()=>[e(g,{name:"elementSearch"}),s(" 搜索 ")]),_:1}),e(_,{onClick:S},{default:o(()=>[e(g,{name:"elementRefresh"}),s(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"]),e(F,{gutter:10,class:"mb8"},{default:o(()=>[e(d,{span:1.5},{default:o(()=>[b((c(),f(_,{type:"danger",plain:"",disabled:t.multiple,onClick:z},{default:o(()=>[e(g,{name:"elementDelete"}),s("删除 ")]),_:1},8,["disabled"])),[[x,"log:operation:delete"]])]),_:1}),e(d,{span:1.5},{default:o(()=>[b((c(),f(_,{type:"danger",plain:"",onClick:B},{default:o(()=>[e(g,{name:"elementDelete"}),s("清空 ")]),_:1})),[[x,"log:operation:clean"]])]),_:1})]),_:1}),b((c(),f(K,{border:"",data:t.tableData,onSelectionChange:U},{default:o(()=>[e(m,{type:"selection",width:"55",align:"center"}),e(m,{label:"日志编号",align:"center",prop:"operId"}),e(m,{label:"系统模块",align:"center",prop:"title"}),e(m,{label:"操作类型",align:"center",prop:"businessType",formatter:w}),e(m,{label:"请求方法",align:"center",prop:"method"}),e(m,{label:"操作人员",align:"center",prop:"operName"}),e(m,{label:"主机",align:"center",prop:"operIp",width:"130","show-overflow-tooltip":!0}),e(m,{label:"操作地点",align:"center",prop:"operLocation","show-overflow-tooltip":!0}),e(m,{label:"操作状态",align:"center",prop:"status"},{default:o(l=>[e(R,{type:l.row.status==="1"?"danger":"success","disable-transitions":""},{default:o(()=>[s(i(h(l.row)),1)]),_:2},1032,["type"])]),_:1}),e(m,{label:"操作日期",align:"center",prop:"createTime"}),e(m,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:o(l=>[e(_,{type:"text",onClick:ie=>I(l.row)},{default:o(()=>[e(g,{name:"elementView"}),s("详细 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[X,t.loading]]),b(D("div",null,[e(Q),e($,{background:"",total:t.total,"current-page":t.queryParams.pageNum,"page-sizes":[10,20,30,40],"page-size":t.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:O,onCurrentChange:L},null,8,["total","current-page","page-size"])],512),[[ee,t.total>0]])]),_:1}),e(W,{title:"操作日志详细",modelValue:t.open,"onUpdate:modelValue":n[4]||(n[4]=l=>t.open=l),width:"700px",center:"","append-to-body":""},{footer:o(()=>[D("span",se,[e(_,{onClick:n[3]||(n[3]=l=>t.open=!1)},{default:o(()=>[s("关 闭")]),_:1})])]),default:o(()=>[e(C,{ref_key:"ruleFormRef",ref:N,model:t.modelForm,"label-width":"100px"},{default:o(()=>[e(F,null,{default:o(()=>[e(d,{span:12},{default:o(()=>[e(p,{label:"操作模块："},{default:o(()=>[s(i(t.modelForm.title)+" / "+i(w(t.modelForm)),1)]),_:1}),e(p,{label:"登录信息："},{default:o(()=>[s(i(t.modelForm.operName)+" / "+i(t.modelForm.operIp)+" / "+i(t.modelForm.operLocation),1)]),_:1})]),_:1}),e(d,{span:12},{default:o(()=>[e(p,{label:"请求地址："},{default:o(()=>[s(i(t.modelForm.operUrl),1)]),_:1})]),_:1}),e(d,{span:24},{default:o(()=>[e(p,{label:"操作方法："},{default:o(()=>[s(i(t.modelForm.method),1)]),_:1})]),_:1}),e(d,{span:24},{default:o(()=>[e(p,{label:"请求参数："},{default:o(()=>[s(i(t.modelForm.operParam),1)]),_:1})]),_:1}),e(d,{span:12},{default:o(()=>[e(p,{label:"操作状态："},{default:o(()=>[s(i(h(t.modelForm)),1)]),_:1})]),_:1}),e(d,{span:12},{default:o(()=>[e(p,{label:"操作时间："},{default:o(()=>[s(i(t.modelForm.createTime),1)]),_:1})]),_:1}),e(d,{span:24},{default:o(()=>[t.modelForm.status==="1"?(c(),f(p,{key:0,label:"异常信息："},{default:o(()=>[s(i(t.modelForm.errorMsg),1)]),_:1})):te("",!0)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});export{Oe as default};
