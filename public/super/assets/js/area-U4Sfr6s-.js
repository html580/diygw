import{b as z,u as U}from"./vue-router-B8aOcPyE.js";import{s as O}from"./pinia-BTdriGDs.js";import{_ as N,g as j,h as W,i as L,j as v,l as X,m as G,k as H,c as J}from"./index-BfYElSN2.js";import{a as f,E as S}from"./element-plus-C9Ov05af.js";import{ag as d,aq as K,o as m,c as P,a as c,X as t,T as i,W as n,U as Y,S as p,x as k,q as Z,F as $,p as ee,v as te,bn as le,bl as ie}from"./@vue-CRBWlwId.js";import"./vue-i18n-Bpsr_IBC.js";import"./@intlify-Bn43FqoL.js";import"./vue-DEEPytDe.js";import"./js-cookie-Cz0CWeBA.js";import"./@element-plus-tztFf6PP.js";import"./nprogress-B-yuMcN-.js";import"./axios-Ds1py3KQ.js";import"./lodash-CnNYTNB6.js";import"./mitt-DJ65BbbF.js";import"./file-saver-B2L8jjWN.js";import"./diygw-datav-DLF-c6uN.js";import"./lodash-es-CW97kIZl.js";import"./@vueuse-BIgT8fdk.js";import"./@popperjs-CER6Qr1e.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-r8A8W4xn.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-DwF5HINA.js";import"./escape-html-HzfLCvW4.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DuJrlvqV.js";const oe={components:{},data(){return{globalOption:{},userInfo:{},ordernum:{code:200,msg:"设置成功"},updatenum:{code:200,msg:"修改成功",data:{id:"1",sortnum:"0"}},loading:!0,ids:[],single:!0,multiple:!0,title:"",total:0,tableData:[],isFullscreen:!1,isShowDialog:!1,saveloading:!1,editFormInit:{},queryParamsInit:{},editFormData:{radioDatas:[{value:"1",label:"有效"},{value:"2",label:"无效"}]},queryParams:{pageNum:1,pageSize:1e6,title_like:""},queryParamsRules:{},editForm:{id:void 0,title:"",radio:"1"},editFormRules:{}}},methods:{getParamData(e,l){l=l||{};let s=e.currentTarget?e.currentTarget.dataset:e;return l&&(s=Object.assign(s,l)),s},navigateTo(e,l){let s=this.getParamData(e,l),{type:r}=s;r=="page"||r=="inner"||r=="href"?this.router.push({path:s.url,query:s}):typeof this[r]=="function"?this[r](s):f.error("待实现点击事件")},async init(){},async ordernumApi(e,l){e=e||{},e=this.getParamData(e);let s="/fang/area/sortnum",r={},o={};if(r.id=e.id,!await this.confirmFunction({title:"确定置顶吗"})){f.error("你已取消");return}let _=await this.$http.post(s,r,o,"json");this.ordernum=_,this.resetQuery()},async updatenumApi(e,l){e=e||{},e=this.getParamData(e);let s="/fang/area/update",r={},o={};if(r.id=e.id,r.sortnum=0,!await this.confirmFunction({title:"确定取消置顶吗"})){f.error("你已取消");return}let _=await this.$http.post(s,r,o,"json");this.updatenum=_,this.resetQuery()},async confirmFunction(e){e=e||{};let l=this,s=e&&(e.title||e.title==0)?e.title:l.title||"";return new Promise(r=>{S({message:s,title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{r(!0)}).catch(()=>{r(!1)})})},openDialog(e){e.id&&e.id!=null&&e.id!=0?this.editForm=j(e,this.editForm):this.initForm(),this.isShowDialog=!0,this.saveloading=!1},closeDialog(e){this.mittBus.emit("onEditAdmintableModule",e),this.isShowDialog=!1},onSubmit(){const e=this.$refs.editFormRef;e&&e.validate(l=>{l?(this.saveloading=!0,this.editForm.id!=null&&this.editForm.id!=0?W("/fang/area",this.editForm).then(()=>{f.success("修改成功"),this.saveloading=!1,this.closeDialog(this.editForm)}).finally(()=>{this.saveloading=!1}):L("/fang/area",this.editForm).then(()=>{f.success("新增成功"),this.saveloading=!1,this.closeDialog(this.editForm)}).finally(()=>{this.saveloading=!1})):f.error("验证未通过！")})},initForm(){this.editForm=v(this.editFormInit)},handleQuery(){this.loading=!0,X("/fang/area",this.queryParams).then(e=>{this.tableData=G(e.rows,"id","parentId","children"),this.total=e.total,this.loading=!1})},resetQuery(){this.queryParams=v(this.queryParamsInit),this.handleQuery()},onOpenAddModule(e){e=[],this.title="添加地区",this.openDialog(e)},onOpenEditModule(e){this.title="修改地区",this.initForm(),this.openDialog(e)},onTabelRowDel(e){let l=this;const s=e.id||this.ids;S({message:"是否确认删除选中的地区?",title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return H("/fang/area",s).then(()=>{l.handleQuery(),f.success("删除成功")})})},handleSelectionChange(e){this.ids=e.map(l=>l.id),this.single=e.length!=1,this.multiple=!e.length},handleSizeChange(e){this.queryParams.pageSize=e,this.handleQuery()},handleCurrentChange(e){this.queryParams.pageNum=e,this.handleQuery()}},async mounted(){this.router=z(),this.globalOption=U().query;const e=J(),{userInfos:l}=O(e);this.userInfo=l,await this.init(),this.editFormInit=v(this.editForm),this.queryParamsInit=v(this.queryParams),this.handleQuery(),this.mittBus.on("onEditAdmintableModule",()=>{this.handleQuery()})},beforeUnmount(){this.mittBus.off("onEditAdmintableModule")}},ae=e=>(le("data-v-6516c626"),e=e(),ie(),e),se={class:"container"},ne={class:"el-card is-always-shadow diygw-col-24"},re={class:"el-card__body"},de={class:"mb8"},ue={class:"flex diygw-col-0"},ce={class:"flex diygw-col-0"},me={class:"mb8"},he=["id"],pe={class:"flex diygw-col-24"},fe={class:"flex diygw-col-12"},_e={class:"flex diygw-col-12"},ge={class:"dialog-footer flex justify-center"},ye=ae(()=>c("div",{class:"clearfix"},null,-1));function be(e,l,s,r,o,u){const _=d("el-input"),w=d("el-form-item"),g=d("SvgIcon"),h=d("el-button"),C=d("el-form"),y=d("el-table-column"),F=d("el-tag"),q=d("el-table"),I=d("FullScreen"),D=d("el-icon"),x=d("el-tooltip"),V=d("Remove"),R=d("el-cascader"),T=d("el-radio"),B=d("el-radio-group"),Q=d("el-dialog"),E=K("loading");return m(),P("div",se,[c("div",ne,[c("div",re,[c("div",de,[t(C,{class:"flex flex-direction-row flex-wrap",model:o.queryParams,rules:o.queryParamsRules,ref:"queryForm","label-width":"80px"},{default:i(()=>[c("div",ue,[t(w,{class:"diygw-el-rate",prop:"title_like",label:"区域名称"},{default:i(()=>[t(_,{type:"text",placeholder:"请输入地区名称查询",modelValue:o.queryParams.title_like,"onUpdate:modelValue":l[0]||(l[0]=a=>o.queryParams.title_like=a)},null,8,["modelValue"])]),_:1})]),c("div",ce,[t(h,{type:"primary",onClick:u.handleQuery},{default:i(()=>[t(g,{name:"ele-Search"}),n(" 搜索 ")]),_:1},8,["onClick"]),n(),t(h,{onClick:u.resetQuery},{default:i(()=>[t(g,{name:"ele-Refresh"}),n(" 重置 ")]),_:1},8,["onClick"])])]),_:1},8,["model","rules"])]),c("div",me,[t(h,{type:"primary",plain:"",onClick:u.onOpenAddModule},{default:i(()=>[t(g,{name:"ele-Plus"}),n("新增 ")]),_:1},8,["onClick"]),n(),t(h,{type:"danger",plain:"",disabled:o.multiple,onClick:u.onTabelRowDel},{default:i(()=>[t(g,{name:"ele-Delete"}),n("删除 ")]),_:1},8,["disabled","onClick"])]),Y((m(),p(q,{onSelectionChange:u.handleSelectionChange,"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},data:o.tableData,stripe:"",border:"","current-row-key":"id","empty-text":"没有数据",style:{width:"100%"}},{default:i(()=>[t(y,{type:"selection",width:"55",align:"center"}),t(y,{label:"置顶",prop:"title",align:"center"},{default:i(a=>[a.row.sortnum>0?(m(),p(F,{key:0,style:{cursor:"pointer"},type:"error",onClick:b=>u.updatenumApi(a.row)},{default:i(()=>[n(" 取消置顶 ")]),_:2},1032,["onClick"])):(m(),p(F,{key:1,style:{cursor:"pointer"},onClick:b=>u.ordernumApi(a.row)},{default:i(()=>[n(" 置顶 ")]),_:2},1032,["onClick"]))]),_:1}),t(y,{label:"区域名称",prop:"title",align:"center"}),t(y,{label:"数据状态",prop:"status",align:"center"},{default:i(a=>[a.row.status==1?(m(),p(F,{key:0},{default:i(()=>[n(" 有效 ")]),_:1})):(m(),p(F,{key:1},{default:i(()=>[n(" 无效 ")]),_:1}))]),_:1}),t(y,{label:"操作",align:"center",fixed:"right",width:"180"},{default:i(a=>[t(h,{type:"primary",plain:"",size:"small",onClick:b=>u.onOpenEditModule(a.row)},{default:i(()=>[t(g,{name:"ele-Edit"}),n("修改 ")]),_:2},1032,["onClick"]),n(),a.row.id!=0?(m(),p(h,{key:0,type:"danger",plain:"",size:"small",onClick:b=>u.onTabelRowDel(a.row)},{default:i(()=>[t(g,{name:"ele-Delete"}),n("删除 ")]),_:2},1032,["onClick"])):k("",!0)]),_:1})]),_:1},8,["onSelectionChange","data"])),[[E,o.loading]])]),t(Q,{fullscreen:o.isFullscreen,width:"800px",modelValue:o.isShowDialog,"onUpdate:modelValue":l[6]||(l[6]=a=>o.isShowDialog=a),"destroy-on-close":"",title:"地区",draggable:"",center:""},{header:i(({close:a,titleId:b,titleClass:A})=>[c("h4",{id:b,class:Z(A)},"地区",10,he),o.isFullscreen?k("",!0):(m(),p(x,{key:0,content:"最大化",placement:"bottom"},{default:i(()=>[t(h,{class:"diygw-max-icon el-dialog__headerbtn"},{default:i(()=>[t(D,{onClick:l[1]||(l[1]=M=>o.isFullscreen=!o.isFullscreen)},{default:i(()=>[t(I)]),_:1})]),_:1})]),_:1})),o.isFullscreen?(m(),p(x,{key:1,content:"返回",placement:"bottom"},{default:i(()=>[t(h,{class:"diygw-max-icon el-dialog__headerbtn"},{default:i(()=>[t(D,{onClick:l[2]||(l[2]=M=>o.isFullscreen=!o.isFullscreen)},{default:i(()=>[t(V)]),_:1})]),_:1})]),_:1})):k("",!0)]),footer:i(()=>[c("div",ge,[t(h,{onClick:u.closeDialog},{default:i(()=>[n(" 取 消 ")]),_:1},8,["onClick"]),n(),t(h,{type:"primary",onClick:u.onSubmit,loading:o.saveloading},{default:i(()=>[n(" 保 存 ")]),_:1},8,["onClick","loading"])])]),default:i(()=>[t(C,{class:"flex flex-direction-row flex-wrap",model:o.editForm,rules:o.editFormRules,ref:"editFormRef","label-width":"120px"},{default:i(()=>[c("div",pe,[t(w,{rules:[{required:!0,trigger:"blur",message:"不能为空哟"}],class:"diygw-el-rate",prop:"title",label:"区域名称"},{default:i(()=>[t(_,{type:"text",placeholder:"请输入区域名称",modelValue:o.editForm.title,"onUpdate:modelValue":l[3]||(l[3]=a=>o.editForm.title=a)},null,8,["modelValue"])]),_:1})]),c("div",fe,[t(w,{prop:"parentId",class:"diygw-el-rate",label:"上级地区"},{default:i(()=>[t(R,{options:o.tableData,class:"w100",modelValue:o.editForm.parentId,"onUpdate:modelValue":l[4]||(l[4]=a=>o.editForm.parentId=a),props:{label:"title",value:"id",checkStrictly:!0,emitPath:!1},clearable:"",filterable:"",placeholder:"请选择上级地区","show-all-levels":!1},null,8,["options","modelValue"])]),_:1})]),c("div",_e,[t(w,{prop:"radio",class:"diygw-el-rate",label:"数据状态"},{default:i(()=>[t(B,{modelValue:o.editForm.radio,"onUpdate:modelValue":l[5]||(l[5]=a=>o.editForm.radio=a)},{default:i(()=>[(m(!0),P($,null,ee(o.editFormData.radioDatas,a=>(m(),p(T,{key:a.value,label:a.value},{default:i(()=>[n(te(a.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),_:1},8,["model","rules"])]),_:1},8,["fullscreen","modelValue"])]),ye])}const Xe=N(oe,[["render",be],["__scopeId","data-v-6516c626"]]);export{Xe as default};
