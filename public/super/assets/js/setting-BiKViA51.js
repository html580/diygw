import{b as L,u as X}from"./vue-router-B8aOcPyE.js";import{s as Y}from"./pinia-BTdriGDs.js";import{_ as G,g as H,h as K,i as Z,j as w,l as $,k as ee,c as te}from"./index-BfYElSN2.js";import{t as le}from"./vue-draggable-plus-D90yCKwz.js";import{D as ie}from"./uploadinput-CMX3D0tT.js";import{ag as r,aq as ae,o as h,c as F,a as o,X as t,T as i,W as n,U as P,S as b,x as C,Y as oe,q as se,Q as ne,F as q,p as z,v as re,bn as de,bl as ue}from"./@vue-CRBWlwId.js";import{a as _,E as I}from"./element-plus-C9Ov05af.js";import"./vue-i18n-Bpsr_IBC.js";import"./@intlify-Bn43FqoL.js";import"./vue-DEEPytDe.js";import"./js-cookie-Cz0CWeBA.js";import"./@element-plus-tztFf6PP.js";import"./nprogress-B-yuMcN-.js";import"./axios-Ds1py3KQ.js";import"./lodash-CnNYTNB6.js";import"./mitt-DJ65BbbF.js";import"./file-saver-B2L8jjWN.js";import"./diygw-datav-DLF-c6uN.js";import"./lodash-es-CW97kIZl.js";import"./@vueuse-BIgT8fdk.js";import"./@popperjs-CER6Qr1e.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-r8A8W4xn.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-DwF5HINA.js";import"./escape-html-HzfLCvW4.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DuJrlvqV.js";const me={components:{VueDraggable:le,DiyUploadinput:ie},data(){return{globalOption:{},userInfo:{},ordernum:{code:200,msg:"设置成功"},updatenum:{code:200,msg:"修改成功",data:{id:"1",sortnum:"0"}},loading:!0,ids:[],single:!0,multiple:!0,title:"",total:0,tableData:[],isFullscreen:!1,isShowDialog:!1,saveloading:!1,editFormInit:{},queryParamsInit:{},valueItem:{label:"",min:"",max:""},editFormData:{radioDatas:[{value:"1",label:"有效"},{value:"2",label:"无效"}]},queryParams:{pageNum:1,pageSize:10,title_like:""},queryParamsRules:{},editForm:{id:void 0,key:"",title:"",upload:"",value:[],radio:"1"},editFormRules:{}}},methods:{getParamData(e,l){l=l||{};let u=e.currentTarget?e.currentTarget.dataset:e;return l&&(u=Object.assign(u,l)),u},navigateTo(e,l){let u=this.getParamData(e,l),{type:m}=u;m=="page"||m=="inner"||m=="href"?this.router.push({path:u.url,query:u}):typeof this[m]=="function"?this[m](u):_.error("待实现点击事件")},async init(){},async ordernumApi(e,l){e=e||{},e=this.getParamData(e);let u="/fang/configPrice/sortnum",m={},a={};if(m.id=e.id,!await this.confirmFunction({title:"确定置顶吗"})){_.error("你已取消");return}let g=await this.$http.post(u,m,a,"json");this.ordernum=g,this.resetQuery()},async updatenumApi(e,l){e=e||{},e=this.getParamData(e);let u="/fang/configPrice/update",m={},a={};if(m.id=e.id,m.sortnum=0,!await this.confirmFunction({title:"确定取消置顶吗"})){_.error("你已取消");return}let g=await this.$http.post(u,m,a,"json");this.updatenum=g,this.resetQuery()},async confirmFunction(e){e=e||{};let l=this,u=e&&(e.title||e.title==0)?e.title:l.title||"";return new Promise(m=>{I({message:u,title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{m(!0)}).catch(()=>{m(!1)})})},initValueData(){for(let e=0;e<1;e++)this.editForm.value.push(JSON.parse(JSON.stringify(this.valueItem)))},upValueItem(e){let{index:l}=e.currentTarget.dataset;if(l==0)return _.error("已经是第一个"),!1;this.editForm.value[l]=this.editForm.value.splice(l-1,1,this.editForm.value[l])[0]},downValueItem(e){let{index:l}=e.currentTarget.dataset;if(l==this.editForm.value.length-1)return _.error("已经是最后一个"),!1;this.editForm.value[l]=this.editForm.value.splice(l+1,1,this.editForm.value[l])[0]},delValueItem(e){let{index:l}=e.currentTarget.dataset;this.editForm.value.splice(l,1)},addValueItem(){this.editForm.value.push(JSON.parse(JSON.stringify(this.valueItem)))},openDialog(e){e.id&&e.id!=null&&e.id!=0?this.editForm=H(e,this.editForm):this.initForm(),this.isShowDialog=!0,this.saveloading=!1},closeDialog(e){this.mittBus.emit("onEditAdmintableModule",e),this.isShowDialog=!1},onSubmit(){const e=this.$refs.editFormRef;e&&e.validate(l=>{l?(this.saveloading=!0,this.editForm.id!=null&&this.editForm.id!=0?K("/fang/setting",this.editForm).then(()=>{_.success("修改成功"),this.saveloading=!1,this.closeDialog(this.editForm)}).finally(()=>{this.saveloading=!1}):Z("/fang/setting",this.editForm).then(()=>{_.success("新增成功"),this.saveloading=!1,this.closeDialog(this.editForm)}).finally(()=>{this.saveloading=!1})):_.error("验证未通过！")})},initForm(){this.editForm=w(this.editFormInit)},handleQuery(){this.loading=!0,$("/fang/setting",this.queryParams).then(e=>{this.tableData=e.rows,this.total=e.total,this.loading=!1})},resetQuery(){this.queryParams=w(this.queryParamsInit),this.handleQuery()},onOpenAddModule(e){e=[],this.title="添加基础设置",this.openDialog(e)},onOpenEditModule(e){this.title="修改基础设置",this.initForm(),this.openDialog(e)},onTabelRowDel(e){let l=this;const u=e.id||this.ids;I({message:"是否确认删除选中的基础设置?",title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return ee("/fang/setting",u).then(()=>{l.handleQuery(),_.success("删除成功")})})},handleSelectionChange(e){this.ids=e.map(l=>l.id),this.single=e.length!=1,this.multiple=!e.length},handleSizeChange(e){this.queryParams.pageSize=e,this.handleQuery()},handleCurrentChange(e){this.queryParams.pageNum=e,this.handleQuery()}},async mounted(){this.router=L(),this.globalOption=X().query;const e=te(),{userInfos:l}=Y(e);this.userInfo=l,await this.init(),this.initValueData(),this.editFormInit=w(this.editForm),this.queryParamsInit=w(this.queryParams),this.handleQuery(),this.mittBus.on("onEditAdmintableModule",()=>{this.handleQuery()})},beforeUnmount(){this.mittBus.off("onEditAdmintableModule")}},T=e=>(de("data-v-0ba575ac"),e=e(),ue(),e),ce={class:"container"},pe={class:"el-card is-always-shadow diygw-col-24"},he={class:"el-card__body"},ge={class:"mb8"},fe={class:"flex diygw-col-0"},_e={class:"flex diygw-col-0"},ye={class:"mb8"},be=["id"],xe={class:"flex diygw-col-12"},ve={class:"flex diygw-col-12"},we={class:"flex diygw-col-24"},Fe={class:"flex diygw-col-24 flex-direction-column"},Ce={class:"flex flex-wrap diygw-col-24 flex-direction-column"},ke={class:"diy-table",cellpadding:"0",cellspacing:"0"},Ve=T(()=>o("thead",null,[o("tr",null,[o("th",null,"操作"),o("th",null,"显示名称"),o("th",null,"最小值(-1表示不限制)"),o("th",null,"最大值(-1表示不限制)")])],-1)),De={style:{"vertical-align":"top"}},Se={class:"padding-xs flex diygw-col-24 justify-end"},Pe={class:"flex diygw-col-0"},qe={class:"flex diygw-col-0"},ze={class:"flex diygw-col-0"},Ie={class:"padding-xs justify-end flex diygw-col-24"},Te={class:"flex diygw-col-12"},Ue={class:"dialog-footer flex justify-center"},Re=T(()=>o("div",{class:"clearfix"},null,-1));function Be(e,l,u,m,a,d){const g=r("el-input"),f=r("el-form-item"),x=r("SvgIcon"),c=r("el-button"),k=r("el-form"),v=r("el-table-column"),V=r("el-tag"),U=r("el-table"),R=r("el-divider"),B=r("el-pagination"),Q=r("FullScreen"),D=r("el-icon"),S=r("el-tooltip"),N=r("Remove"),O=r("diy-uploadinput"),E=r("vue-draggable"),M=r("el-radio"),j=r("el-radio-group"),A=r("el-dialog"),J=ae("loading");return h(),F("div",ce,[o("div",pe,[o("div",he,[o("div",ge,[t(k,{class:"flex flex-direction-row flex-wrap",model:a.queryParams,rules:a.queryParamsRules,ref:"queryForm","label-width":"80px"},{default:i(()=>[o("div",fe,[t(f,{class:"diygw-el-rate",prop:"title_like",label:"名称"},{default:i(()=>[t(g,{type:"text",placeholder:"请输入名称查询",modelValue:a.queryParams.title_like,"onUpdate:modelValue":l[0]||(l[0]=s=>a.queryParams.title_like=s)},null,8,["modelValue"])]),_:1})]),o("div",_e,[t(c,{type:"primary",onClick:d.handleQuery},{default:i(()=>[t(x,{name:"ele-Search"}),n(" 搜索 ")]),_:1},8,["onClick"]),n(),t(c,{onClick:d.resetQuery},{default:i(()=>[t(x,{name:"ele-Refresh"}),n(" 重置 ")]),_:1},8,["onClick"])])]),_:1},8,["model","rules"])]),o("div",ye,[t(c,{type:"primary",plain:"",onClick:d.onOpenAddModule},{default:i(()=>[t(x,{name:"ele-Plus"}),n("新增 ")]),_:1},8,["onClick"]),n(),t(c,{type:"danger",plain:"",disabled:a.multiple,onClick:d.onTabelRowDel},{default:i(()=>[t(x,{name:"ele-Delete"}),n("删除 ")]),_:1},8,["disabled","onClick"])]),P((h(),b(U,{onSelectionChange:d.handleSelectionChange,data:a.tableData,stripe:"",border:"","current-row-key":"id","empty-text":"没有数据",style:{width:"100%"}},{default:i(()=>[t(v,{type:"selection",width:"55",align:"center"}),t(v,{label:"关键词",prop:"key",align:"center"}),t(v,{label:"名称",prop:"title",align:"center"}),t(v,{label:"数据状态",prop:"status",align:"center"},{default:i(s=>[s.row.status==1?(h(),b(V,{key:0},{default:i(()=>[n(" 有效 ")]),_:1})):(h(),b(V,{key:1},{default:i(()=>[n(" 无效 ")]),_:1}))]),_:1}),t(v,{label:"操作",align:"center",fixed:"right",width:"180"},{default:i(s=>[t(c,{type:"primary",plain:"",size:"small",onClick:p=>d.onOpenEditModule(s.row)},{default:i(()=>[t(x,{name:"ele-Edit"}),n("修改 ")]),_:2},1032,["onClick"]),n(),s.row.id!=0?(h(),b(c,{key:0,type:"danger",plain:"",size:"small",onClick:p=>d.onTabelRowDel(s.row)},{default:i(()=>[t(x,{name:"ele-Delete"}),n("删除 ")]),_:2},1032,["onClick"])):C("",!0)]),_:1})]),_:1},8,["onSelectionChange","data"])),[[J,a.loading]]),P(o("div",null,[t(R),n(),t(B,{background:"",total:a.total,"current-page":a.queryParams.pageNum,"page-size":a.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:d.handleSizeChange,onCurrentChange:d.handleCurrentChange},null,8,["total","current-page","page-size","onSizeChange","onCurrentChange"])],512),[[oe,a.total>0]])]),t(A,{fullscreen:a.isFullscreen,width:"1000px",modelValue:a.isShowDialog,"onUpdate:modelValue":l[8]||(l[8]=s=>a.isShowDialog=s),"destroy-on-close":"",title:"基础设置",draggable:"",center:""},{header:i(({close:s,titleId:p,titleClass:y})=>[o("h4",{id:p,class:se(y)},"基础设置",10,be),a.isFullscreen?C("",!0):(h(),b(S,{key:0,content:"最大化",placement:"bottom"},{default:i(()=>[t(c,{class:"diygw-max-icon el-dialog__headerbtn"},{default:i(()=>[t(D,{onClick:l[1]||(l[1]=W=>a.isFullscreen=!a.isFullscreen)},{default:i(()=>[t(Q)]),_:1})]),_:1})]),_:1})),a.isFullscreen?(h(),b(S,{key:1,content:"返回",placement:"bottom"},{default:i(()=>[t(c,{class:"diygw-max-icon el-dialog__headerbtn"},{default:i(()=>[t(D,{onClick:l[2]||(l[2]=W=>a.isFullscreen=!a.isFullscreen)},{default:i(()=>[t(N)]),_:1})]),_:1})]),_:1})):C("",!0)]),footer:i(()=>[o("div",Ue,[t(c,{onClick:d.closeDialog},{default:i(()=>[n(" 取 消 ")]),_:1},8,["onClick"]),n(),t(c,{type:"primary",onClick:d.onSubmit,loading:a.saveloading},{default:i(()=>[n(" 保 存 ")]),_:1},8,["onClick","loading"])])]),default:i(()=>[t(k,{class:"flex flex-direction-row flex-wrap",model:a.editForm,rules:a.editFormRules,ref:"editFormRef","label-width":"120px"},{default:i(()=>[o("div",xe,[t(f,{rules:[{required:!0,trigger:"blur",message:"不能为空哟"}],class:"diygw-el-rate",prop:"key",label:"关键词"},{default:i(()=>[t(g,{type:"text",placeholder:"请输入关键词",modelValue:a.editForm.key,"onUpdate:modelValue":l[3]||(l[3]=s=>a.editForm.key=s)},null,8,["modelValue"])]),_:1})]),o("div",ve,[t(f,{rules:[{required:!0,trigger:"blur",message:"不能为空哟"}],class:"diygw-el-rate",prop:"title",label:"名称"},{default:i(()=>[t(g,{type:"text",placeholder:"请输入名称",modelValue:a.editForm.title,"onUpdate:modelValue":l[4]||(l[4]=s=>a.editForm.title=s)},null,8,["modelValue"])]),_:1})]),o("div",we,[t(f,{prop:"upload",class:"diygw-el-rate",label:"上传"},{default:i(()=>[t(O,{modelValue:a.editForm.upload,"onUpdate:modelValue":l[5]||(l[5]=s=>a.editForm.upload=s),title:"上传"},null,8,["modelValue"])]),_:1})]),o("div",Fe,[t(f,{class:"diygw-el-rate",prop:"value",label:"单行输入"},{default:i(()=>[o("div",Ce,[o("table",ke,[Ve,t(E,ne({tag:"tbody"},{animation:200,disabled:!1,ghostClass:"ghost"},{modelValue:a.editForm.value,"onUpdate:modelValue":l[6]||(l[6]=s=>a.editForm.value=s),group:"value",handle:".handle","item-key":"id"}),{default:i(()=>[(h(!0),F(q,null,z(a.editForm.value,(s,p)=>(h(),F("tr",null,[o("th",De,[o("div",Se,[t(c,{size:"small",type:"primary",class:"handle radius margin-xs"},{default:i(()=>[n(" 拖动 ")]),_:1}),n(),t(c,{size:"small",onClick:d.upValueItem,"data-index":p,type:"primary",class:"radius margin-xs"},{default:i(()=>[n(" 上移 ")]),_:2},1032,["onClick","data-index"]),n(),t(c,{size:"small",onClick:d.downValueItem,"data-index":p,type:"primary",class:"radius margin-xs"},{default:i(()=>[n(" 下移 ")]),_:2},1032,["onClick","data-index"]),t(c,{size:"small",onClick:d.delValueItem,"data-index":p,type:"danger",class:"radius margin-xs"},{default:i(()=>[n(" 删除 ")]),_:2},1032,["onClick","data-index"]),n(),t(c,{size:"small",onClick:d.addValueItem,"data-index":p,type:"primary",class:"radius margin-xs"},{default:i(()=>[n(" 新增 ")]),_:2},1032,["onClick","data-index"])])]),o("th",null,[o("div",Pe,[t(f,{rules:[{required:!0,trigger:"blur",message:"显示名称不能为空"}],class:"diygw-el-rate",prop:`value.${p}.label`,"label-width":"0px"},{default:i(()=>[t(g,{type:"text",placeholder:"请输入显示名称",modelValue:s.label,"onUpdate:modelValue":y=>s.label=y},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])])]),o("th",null,[o("div",qe,[t(f,{class:"diygw-el-rate",prop:`value.${p}.min`,"label-width":"0px"},{default:i(()=>[t(g,{type:"text",placeholder:"最小值(-1表示不限制)",modelValue:s.min,"onUpdate:modelValue":y=>s.min=y},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])])]),o("th",null,[o("div",ze,[t(f,{class:"diygw-el-rate",prop:`value.${p}.max`,"label-width":"0px"},{default:i(()=>[t(g,{type:"text",placeholder:"最大值(-1表示不限制)",modelValue:s.max,"onUpdate:modelValue":y=>s.max=y},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])])])]))),256))]),_:1},16,["modelValue"])]),o("div",Ie,[t(c,{size:"small",onClick:d.addValueItem,type:"primary",class:"radius margin-xs"},{default:i(()=>[n(" 新增 ")]),_:1},8,["onClick"])])])]),_:1})]),o("div",Te,[t(f,{prop:"radio",class:"diygw-el-rate",label:"数据状态"},{default:i(()=>[t(j,{modelValue:a.editForm.radio,"onUpdate:modelValue":l[7]||(l[7]=s=>a.editForm.radio=s)},{default:i(()=>[(h(!0),F(q,null,z(a.editFormData.radioDatas,s=>(h(),b(M,{key:s.value,label:s.value},{default:i(()=>[n(re(s.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),_:1},8,["model","rules"])]),_:1},8,["fullscreen","modelValue"])]),Re])}const mt=G(me,[["render",Be],["__scopeId","data-v-0ba575ac"]]);export{mt as default};
