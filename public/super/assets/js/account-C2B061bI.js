import{u as N,b as B}from"./vue-router-B8aOcPyE.js";import{v as U}from"./vue-i18n-Bpsr_IBC.js";import{a as $}from"./js-cookie-Cz0CWeBA.js";import{u as P,p as D,r as F,S as I,s as j,t as A,N as E,_ as z}from"./index-BfYElSN2.js";import{a as L}from"./formatTime-Bwg9I4Gs.js";import{s as O}from"./pinia-BTdriGDs.js";import{a as J}from"./element-plus-C9Ov05af.js";import{d as M,h as w,m as _,j as X,ag as n,o as G,S as H,T as o,X as t,a as h,q as K,v as Q}from"./@vue-CRBWlwId.js";import"./@intlify-Bn43FqoL.js";import"./vue-DEEPytDe.js";import"./@element-plus-tztFf6PP.js";import"./nprogress-B-yuMcN-.js";import"./axios-Ds1py3KQ.js";import"./lodash-CnNYTNB6.js";import"./mitt-DJ65BbbF.js";import"./file-saver-B2L8jjWN.js";import"./diygw-datav-DLF-c6uN.js";import"./lodash-es-CW97kIZl.js";import"./@vueuse-BIgT8fdk.js";import"./@popperjs-CER6Qr1e.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-r8A8W4xn.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-DwF5HINA.js";import"./escape-html-HzfLCvW4.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DuJrlvqV.js";const W=M({__name:"account",setup(Y){const{t:f}=U.useI18n(),y=P(),{themeConfig:k}=O(y),u=N(),g=B(),v=w(),a=_({username:"",password:""}),x=_({username:[{required:!0,message:f("message.account.accountPlaceholder1"),trigger:"blur"}],password:[{required:!0,message:f("message.account.accountPlaceholder2"),trigger:"blur"}]}),c=w(!1),p=_({signIn:!1}),C=X(()=>L(new Date)),R=()=>{g.push({path:"/reg"})},T=async()=>{v.value.validate(s=>{s&&D("/admin/login/login",{username:a.username,password:a.password}).then(async e=>{p.signIn=!0;const r={userId:e.data.userId,userName:a.username,nickname:e.data.nickname,avatar:e.data.avatar||F(e.data.username),time:new Date().getTime(),roles:e.data.roles,authBtnList:e.data.auths};I.set("token",e.data.token),I.set("userInfo",r),p.signIn=!0,$.set("userName",a.username),k.value.isRequestRoutes?await A():await j(),b()})})},b=()=>{var r,l,m,i;let s=C.value;(r=u.query)!=null&&r.redirect?g.push({path:(l=u.query)==null?void 0:l.redirect,query:Object.keys((m=u.query)==null?void 0:m.params).length>0?JSON.parse((i=u.query)==null?void 0:i.params):""}):g.push("/"),p.signIn=!0;const e=f("message.signInText");J.success(`${s}，${e}`),E.start()};return(s,e)=>{const r=n("ele-User"),l=n("el-icon"),m=n("el-input"),i=n("el-form-item"),q=n("ele-Unlock"),S=n("el-button"),V=n("el-form");return G(),H(V,{size:"large",ref_key:"loginFormRef",ref:v,model:a,class:"login-content-form",rules:x},{default:o(()=>[t(i,{class:"login-animation1",prop:"username"},{default:o(()=>[t(m,{type:"text",placeholder:s.$t("message.account.accountPlaceholder1"),modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=d=>a.username=d),clearable:"",autocomplete:"off"},{prefix:o(()=>[t(l,{class:"el-input__icon"},{default:o(()=>[t(r)]),_:1})]),_:1},8,["placeholder","modelValue"])]),_:1}),t(i,{class:"login-animation2",prop:"password"},{default:o(()=>[t(m,{type:c.value?"text":"password",placeholder:s.$t("message.account.accountPlaceholder2"),modelValue:a.password,"onUpdate:modelValue":e[2]||(e[2]=d=>a.password=d),clearable:"",autocomplete:"off"},{prefix:o(()=>[t(l,{class:"el-input__icon"},{default:o(()=>[t(q)]),_:1})]),suffix:o(()=>[h("i",{class:K(["iconfont el-input__icon login-content-password",c.value?"icon-yincangmima":"icon-xianshimima"]),onClick:e[1]||(e[1]=d=>c.value=!c.value)},null,2)]),_:1},8,["type","placeholder","modelValue"])]),_:1}),t(i,{class:"login-animation4"},{default:o(()=>[t(S,{type:"primary",class:"login-content-submit",round:"",onClick:T,loading:p.signIn},{default:o(()=>[h("span",null,Q(s.$t("message.account.accountBtnText")),1)]),_:1},8,["loading"])]),_:1}),h("div",{class:"font12 mt30 login-animation4 login-msg text-center",onClick:R},"注册用户")]),_:1},8,["model","rules"])}}}),Te=z(W,[["__scopeId","data-v-f51def88"]]);export{Te as default};
