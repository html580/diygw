import{d as j,m as A,$ as W,f as X,k as Y,ag as i,aq as J,o as u,c as f,X as o,T as t,u as s,a8 as O,W as m,U as S,S as C,Y as Z,a as c,v as D,F as x,p as V,e as ee}from"./@vue-CRBWlwId.js";import{l as oe,p as te}from"./index-BfYElSN2.js";import"./pinia-BTdriGDs.js";import"./vue-router-B8aOcPyE.js";import"./vue-i18n-Bpsr_IBC.js";import"./@intlify-Bn43FqoL.js";import"./vue-DEEPytDe.js";import"./js-cookie-Cz0CWeBA.js";import"./@element-plus-tztFf6PP.js";import"./nprogress-B-yuMcN-.js";import"./axios-Ds1py3KQ.js";import"./element-plus-C9Ov05af.js";import"./lodash-es-CW97kIZl.js";import"./@vueuse-BIgT8fdk.js";import"./@popperjs-CER6Qr1e.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-r8A8W4xn.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-DwF5HINA.js";import"./escape-html-HzfLCvW4.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DuJrlvqV.js";import"./lodash-CnNYTNB6.js";import"./mitt-DJ65BbbF.js";import"./file-saver-B2L8jjWN.js";import"./diygw-datav-DLF-c6uN.js";const ae={class:"container"},le={class:"gen-body"},ne={class:"margin-bottom"},ie={class:"dialog-footer"},se={class:"gen-body"},re=["innerHTML"],Ie=j({__name:"index",setup(de){const{proxy:b}=ee(),e=A({isShowDialog:!1,isShowGenDialog:!1,msg:"",names:"",datas:[],loading:!0,ids:[],single:!0,multiple:!0,title:"",tableData:[],total:0,options:[{value:"diygw:tableandapi",label:"创建表相关Model、Controller、API等类"},{value:"diygw:table",label:"创建表相关Model、Controller等类"},{value:"diygw:model",label:"创建Model类"}],type:"diygw:tableandapi",queryParams:{pageNum:1,pageSize:10,name:void 0,comment:void 0,status:void 0},dictItemForm:[]}),{loading:k,multiple:P,tableData:q,total:v,queryParams:_}=W(e),r=()=>{e.loading=!0,oe("/sys/database",e.queryParams).then(l=>{e.tableData=l.rows,e.total=l.total,e.loading=!1})},z=()=>{e.queryParams.name=void 0,e.queryParams.comment=void 0,e.queryParams.status=void 0,r()},M=()=>te("/sys/database/generate",{names:e.names,type:e.type}).then(l=>{e.isShowGenDialog=!1,e.datas=l.data,e.isShowDialog=!0}),h=l=>{const n=l.name||e.ids;e.names=n,e.msg='是否确认生成表格编号为"'+n+'"的表格？如果已生成不会重复生成。',e.isShowGenDialog=!0},B=l=>{e.ids=l.map(n=>n.name),e.single=l.length!=1,e.multiple=!l.length},G=l=>{e.queryParams.pageSize=l,r()},N=l=>{e.queryParams.pageNum=l,r()};return X(()=>{r(),b.mittBus.on("onEditPostModule",()=>{r()})}),Y(()=>{b.mittBus.off("onEditPostModule")}),(l,n)=>{const T=i("el-input"),y=i("el-form-item"),g=i("SvgIcon"),p=i("el-button"),U=i("el-form"),I=i("el-col"),E=i("el-row"),d=i("el-table-column"),F=i("el-table"),L=i("el-divider"),R=i("el-pagination"),$=i("el-card"),H=i("el-radio"),K=i("el-radio-group"),w=i("el-dialog"),Q=J("loading");return u(),f("div",ae,[o($,{shadow:"always"},{default:t(()=>[o(U,{model:s(_),ref:"queryForm",inline:!0,"label-width":"68px"},{default:t(()=>[o(y,{label:"表格名称",prop:"name"},{default:t(()=>[o(T,{placeholder:"请输入表格名称或备注模糊查询",clearable:"",onKeyup:O(r,["enter"]),style:{width:"240px"},modelValue:s(_).name,"onUpdate:modelValue":n[0]||(n[0]=a=>s(_).name=a)},null,8,["modelValue"])]),_:1}),o(y,null,{default:t(()=>[o(p,{type:"primary",onClick:r},{default:t(()=>[o(g,{name:"ele-Search"}),m("搜索 ")]),_:1}),o(p,{onClick:z},{default:t(()=>[o(g,{name:"ele-Refresh"}),m(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"]),o(E,{gutter:10,class:"mb8"},{default:t(()=>[o(I,{span:1.5},{default:t(()=>[o(p,{type:"danger",plain:"",disabled:s(P),onClick:h},{default:t(()=>[o(g,{name:"ele-Download"}),m("生成 ")]),_:1},8,["disabled"])]),_:1})]),_:1}),S((u(),C(F,{border:"",data:s(q),onSelectionChange:B},{default:t(()=>[o(d,{type:"selection",align:"center"}),o(d,{prop:"name",label:"表名"}),o(d,{prop:"comment",label:"注释"}),o(d,{prop:"engine",label:"引擎"}),o(d,{prop:"collation",label:"字符集"}),o(d,{prop:"rows",label:"数据行数"}),o(d,{label:"操作",align:"center",fixed:"right",width:"280"},{default:t(a=>[o(p,{type:"text",icon:"el-icon-s-tools",onClick:me=>h(a.row)},{default:t(()=>[o(g,{name:"ele-Download"}),m("生成 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Q,s(k)]]),S(c("div",null,[o(L),o(R,{background:"",total:s(v),"current-page":s(_).pageNum,"page-size":s(_).pageSize,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:G,onCurrentChange:N},null,8,["total","current-page","page-size"])],512),[[Z,s(v)>0]])]),_:1}),o(w,{modelValue:e.isShowGenDialog,"onUpdate:modelValue":n[3]||(n[3]=a=>e.isShowGenDialog=a),width:"600px","destroy-on-close":"",title:"生成内容",draggable:"",center:""},{footer:t(()=>[c("div",ie,[o(p,{onClick:n[2]||(n[2]=a=>e.isShowGenDialog=!1)},{default:t(()=>[m(" 取 消 ")]),_:1}),o(p,{type:"primary",onClick:M},{default:t(()=>[m(" 生成 ")]),_:1})])]),default:t(()=>[c("div",le,[c("div",ne,D(e.msg),1),o(y,{label:"生成类型",prop:"configType"},{default:t(()=>[o(K,{class:"flex align-start flex-direction-column",modelValue:e.type,"onUpdate:modelValue":n[1]||(n[1]=a=>e.type=a)},{default:t(()=>[(u(!0),f(x,null,V(e.options,a=>(u(),C(H,{value:a.value,key:a.value,label:a.value},{default:t(()=>[m(D(a.label),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),_:1},8,["modelValue"]),o(w,{modelValue:e.isShowDialog,"onUpdate:modelValue":n[4]||(n[4]=a=>e.isShowDialog=a),width:"600px","destroy-on-close":"",title:"提示信息",draggable:"",center:""},{default:t(()=>[c("div",se,[(u(!0),f(x,null,V(e.datas,a=>(u(),f("div",null,[c("div",{innerHTML:a},null,8,re)]))),256))])]),_:1},8,["modelValue"])])}}});export{Ie as default};
