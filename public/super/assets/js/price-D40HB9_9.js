import{b as j,u as W}from"./vue-router-B8aOcPyE.js";import{s as L}from"./pinia-BTdriGDs.js";import{_ as X,g as Y,h as G,i as H,j as F,l as J,k as K,c as Z}from"./index-BfYElSN2.js";import{ag as a,aq as $,o as m,c as q,a as u,X as t,T as o,W as s,U as V,S as h,x as C,Y as ee,q as te,F as le,p as ie,v as oe,bn as ne,bl as ae}from"./@vue-CRBWlwId.js";import{a as _,E as I}from"./element-plus-C9Ov05af.js";import"./vue-i18n-Bpsr_IBC.js";import"./@intlify-Bn43FqoL.js";import"./vue-DEEPytDe.js";import"./js-cookie-Cz0CWeBA.js";import"./@element-plus-tztFf6PP.js";import"./nprogress-B-yuMcN-.js";import"./axios-Ds1py3KQ.js";import"./lodash-CnNYTNB6.js";import"./mitt-DJ65BbbF.js";import"./file-saver-B2L8jjWN.js";import"./diygw-datav-DLF-c6uN.js";import"./lodash-es-CW97kIZl.js";import"./@vueuse-BIgT8fdk.js";import"./@popperjs-CER6Qr1e.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-r8A8W4xn.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-DwF5HINA.js";import"./escape-html-HzfLCvW4.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DuJrlvqV.js";const se={components:{},data(){return{globalOption:{},userInfo:{},ordernum:{code:200,msg:"设置成功"},updatenum:{code:200,msg:"修改成功",data:{id:"1",sortnum:"0"}},loading:!0,ids:[],single:!0,multiple:!0,title:"",total:0,tableData:[],isFullscreen:!1,isShowDialog:!1,saveloading:!1,editFormInit:{},queryParamsInit:{},editFormData:{radioDatas:[{value:"1",label:"有效"},{value:"2",label:"无效"}]},queryParams:{pageNum:1,pageSize:10,title_like:""},queryParamsRules:{},editForm:{id:void 0,title:"",start:"",end:"",radio:"1"},editFormRules:{}}},methods:{getParamData(e,i){i=i||{};let r=e.currentTarget?e.currentTarget.dataset:e;return i&&(r=Object.assign(r,i)),r},navigateTo(e,i){let r=this.getParamData(e,i),{type:d}=r;d=="page"||d=="inner"||d=="href"?this.router.push({path:r.url,query:r}):typeof this[d]=="function"?this[d](r):_.error("待实现点击事件")},async init(){},async ordernumApi(e,i){e=e||{},e=this.getParamData(e);let r="/fang/configPrice/sortnum",d={},l={};if(d.id=e.id,!await this.confirmFunction({title:"确定置顶吗"})){_.error("你已取消");return}let f=await this.$http.post(r,d,l,"json");this.ordernum=f,this.resetQuery()},async updatenumApi(e,i){e=e||{},e=this.getParamData(e);let r="/fang/configPrice/update",d={},l={};if(d.id=e.id,d.sortnum=0,!await this.confirmFunction({title:"确定取消置顶吗"})){_.error("你已取消");return}let f=await this.$http.post(r,d,l,"json");this.updatenum=f,this.resetQuery()},async confirmFunction(e){e=e||{};let i=this,r=e&&(e.title||e.title==0)?e.title:i.title||"";return new Promise(d=>{I({message:r,title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{d(!0)}).catch(()=>{d(!1)})})},openDialog(e){e.id&&e.id!=null&&e.id!=0?this.editForm=Y(e,this.editForm):this.initForm(),this.isShowDialog=!0,this.saveloading=!1},closeDialog(e){this.mittBus.emit("onEditAdmintableModule",e),this.isShowDialog=!1},onSubmit(){const e=this.$refs.editFormRef;e&&e.validate(i=>{i?(this.saveloading=!0,this.editForm.id!=null&&this.editForm.id!=0?G("/fang/configPrice",this.editForm).then(()=>{_.success("修改成功"),this.saveloading=!1,this.closeDialog(this.editForm)}).finally(()=>{this.saveloading=!1}):H("/fang/configPrice",this.editForm).then(()=>{_.success("新增成功"),this.saveloading=!1,this.closeDialog(this.editForm)}).finally(()=>{this.saveloading=!1})):_.error("验证未通过！")})},initForm(){this.editForm=F(this.editFormInit)},handleQuery(){this.loading=!0,J("/fang/configPrice",this.queryParams).then(e=>{this.tableData=e.rows,this.total=e.total,this.loading=!1})},resetQuery(){this.queryParams=F(this.queryParamsInit),this.handleQuery()},onOpenAddModule(e){e=[],this.title="添加搜索价格",this.openDialog(e)},onOpenEditModule(e){this.title="修改搜索价格",this.initForm(),this.openDialog(e)},onTabelRowDel(e){let i=this;const r=e.id||this.ids;I({message:"是否确认删除选中的搜索价格?",title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return K("/fang/configPrice",r).then(()=>{i.handleQuery(),_.success("删除成功")})})},handleSelectionChange(e){this.ids=e.map(i=>i.id),this.single=e.length!=1,this.multiple=!e.length},handleSizeChange(e){this.queryParams.pageSize=e,this.handleQuery()},handleCurrentChange(e){this.queryParams.pageNum=e,this.handleQuery()}},async mounted(){this.router=j(),this.globalOption=W().query;const e=Z(),{userInfos:i}=L(e);this.userInfo=i,await this.init(),this.editFormInit=F(this.editForm),this.queryParamsInit=F(this.queryParams),this.handleQuery(),this.mittBus.on("onEditAdmintableModule",()=>{this.handleQuery()})},beforeUnmount(){this.mittBus.off("onEditAdmintableModule")}},k=e=>(ne("data-v-34639ae0"),e=e(),ae(),e),re={class:"container"},de={class:"el-card is-always-shadow diygw-col-24"},ue={class:"el-card__body"},ce={class:"mb8"},me={class:"flex diygw-col-0"},pe={class:"flex diygw-col-0"},he={class:"mb8"},ge=["id"],_e={class:"flex diygw-col-24"},fe={class:"flex diygw-col-12"},ye=k(()=>u("div",{class:"diygw-help-text"},"-1表示不限",-1)),be={class:"flex diygw-col-12"},we=k(()=>u("div",{class:"diygw-help-text"},"-1表示不限",-1)),ve={class:"flex diygw-col-12"},Fe={class:"dialog-footer flex justify-center"},Ce=k(()=>u("div",{class:"clearfix"},null,-1));function ke(e,i,r,d,l,c){const f=a("el-input"),b=a("el-form-item"),y=a("SvgIcon"),p=a("el-button"),x=a("el-form"),g=a("el-table-column"),v=a("el-tag"),R=a("el-table"),z=a("el-divider"),B=a("el-pagination"),T=a("FullScreen"),D=a("el-icon"),S=a("el-tooltip"),Q=a("Remove"),P=a("el-input-number"),E=a("el-radio"),A=a("el-radio-group"),M=a("el-dialog"),U=$("loading");return m(),q("div",re,[u("div",de,[u("div",ue,[u("div",ce,[t(x,{class:"flex flex-direction-row flex-wrap",model:l.queryParams,rules:l.queryParamsRules,ref:"queryForm","label-width":"80px"},{default:o(()=>[u("div",me,[t(b,{class:"diygw-el-rate",prop:"title_like",label:"价格名称"},{default:o(()=>[t(f,{type:"text",placeholder:"请输入价格名称查询",modelValue:l.queryParams.title_like,"onUpdate:modelValue":i[0]||(i[0]=n=>l.queryParams.title_like=n)},null,8,["modelValue"])]),_:1})]),u("div",pe,[t(p,{type:"primary",onClick:c.handleQuery},{default:o(()=>[t(y,{name:"ele-Search"}),s(" 搜索 ")]),_:1},8,["onClick"]),s(),t(p,{onClick:c.resetQuery},{default:o(()=>[t(y,{name:"ele-Refresh"}),s(" 重置 ")]),_:1},8,["onClick"])])]),_:1},8,["model","rules"])]),u("div",he,[t(p,{type:"primary",plain:"",onClick:c.onOpenAddModule},{default:o(()=>[t(y,{name:"ele-Plus"}),s("新增 ")]),_:1},8,["onClick"]),s(),t(p,{type:"danger",plain:"",disabled:l.multiple,onClick:c.onTabelRowDel},{default:o(()=>[t(y,{name:"ele-Delete"}),s("删除 ")]),_:1},8,["disabled","onClick"])]),V((m(),h(R,{onSelectionChange:c.handleSelectionChange,data:l.tableData,stripe:"",border:"","current-row-key":"id","empty-text":"没有数据",style:{width:"100%"}},{default:o(()=>[t(g,{type:"selection",width:"55",align:"center"}),t(g,{label:"置顶",prop:"title",align:"center"},{default:o(n=>[n.row.sortnum>0?(m(),h(v,{key:0,style:{cursor:"pointer"},type:"error",onClick:w=>c.updatenumApi(n.row)},{default:o(()=>[s(" 取消置顶 ")]),_:2},1032,["onClick"])):(m(),h(v,{key:1,style:{cursor:"pointer"},onClick:w=>c.ordernumApi(n.row)},{default:o(()=>[s(" 置顶 ")]),_:2},1032,["onClick"]))]),_:1}),t(g,{label:"价格名称",prop:"title",align:"center"}),t(g,{label:"最小值",prop:"start",align:"center"}),t(g,{label:"最大值",prop:"start",align:"center"}),t(g,{label:"数据状态",prop:"status",align:"center"},{default:o(n=>[n.row.status==1?(m(),h(v,{key:0},{default:o(()=>[s(" 有效 ")]),_:1})):(m(),h(v,{key:1},{default:o(()=>[s(" 无效 ")]),_:1}))]),_:1}),t(g,{label:"操作",align:"center",fixed:"right",width:"180"},{default:o(n=>[t(p,{type:"primary",plain:"",size:"small",onClick:w=>c.onOpenEditModule(n.row)},{default:o(()=>[t(y,{name:"ele-Edit"}),s("修改 ")]),_:2},1032,["onClick"]),s(),n.row.id!=0?(m(),h(p,{key:0,type:"danger",plain:"",size:"small",onClick:w=>c.onTabelRowDel(n.row)},{default:o(()=>[t(y,{name:"ele-Delete"}),s("删除 ")]),_:2},1032,["onClick"])):C("",!0)]),_:1})]),_:1},8,["onSelectionChange","data"])),[[U,l.loading]]),V(u("div",null,[t(z),s(),t(B,{background:"",total:l.total,"current-page":l.queryParams.pageNum,"page-size":l.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:c.handleSizeChange,onCurrentChange:c.handleCurrentChange},null,8,["total","current-page","page-size","onSizeChange","onCurrentChange"])],512),[[ee,l.total>0]])]),t(M,{fullscreen:l.isFullscreen,width:"800px",modelValue:l.isShowDialog,"onUpdate:modelValue":i[7]||(i[7]=n=>l.isShowDialog=n),"destroy-on-close":"",title:"搜索价格",draggable:"",center:""},{header:o(({close:n,titleId:w,titleClass:N})=>[u("h4",{id:w,class:te(N)},"搜索价格",10,ge),l.isFullscreen?C("",!0):(m(),h(S,{key:0,content:"最大化",placement:"bottom"},{default:o(()=>[t(p,{class:"diygw-max-icon el-dialog__headerbtn"},{default:o(()=>[t(D,{onClick:i[1]||(i[1]=O=>l.isFullscreen=!l.isFullscreen)},{default:o(()=>[t(T)]),_:1})]),_:1})]),_:1})),l.isFullscreen?(m(),h(S,{key:1,content:"返回",placement:"bottom"},{default:o(()=>[t(p,{class:"diygw-max-icon el-dialog__headerbtn"},{default:o(()=>[t(D,{onClick:i[2]||(i[2]=O=>l.isFullscreen=!l.isFullscreen)},{default:o(()=>[t(Q)]),_:1})]),_:1})]),_:1})):C("",!0)]),footer:o(()=>[u("div",Fe,[t(p,{onClick:c.closeDialog},{default:o(()=>[s(" 取 消 ")]),_:1},8,["onClick"]),s(),t(p,{type:"primary",onClick:c.onSubmit,loading:l.saveloading},{default:o(()=>[s(" 保 存 ")]),_:1},8,["onClick","loading"])])]),default:o(()=>[t(x,{class:"flex flex-direction-row flex-wrap",model:l.editForm,rules:l.editFormRules,ref:"editFormRef","label-width":"120px"},{default:o(()=>[u("div",_e,[t(b,{rules:[{required:!0,trigger:"blur",message:"不能为空哟"}],class:"diygw-el-rate",prop:"title",label:"价格名称"},{default:o(()=>[t(f,{type:"text",placeholder:"请输入价格名称",modelValue:l.editForm.title,"onUpdate:modelValue":i[3]||(i[3]=n=>l.editForm.title=n)},null,8,["modelValue"])]),_:1})]),u("div",fe,[t(b,{prop:"start",class:"diygw-el-rate",label:"最小价格"},{default:o(()=>[t(P,{min:"-1",max:"10000000000",step:"1",controls:"","controls-position":"right",placeholder:"输入数字",modelValue:l.editForm.start,"onUpdate:modelValue":i[4]||(i[4]=n=>l.editForm.start=n)},null,8,["modelValue"]),ye]),_:1})]),u("div",be,[t(b,{prop:"end",class:"diygw-el-rate",label:"最大价格"},{default:o(()=>[t(P,{min:"-1",max:"10000000000",step:"1",controls:"","controls-position":"right",placeholder:"输入数字",modelValue:l.editForm.end,"onUpdate:modelValue":i[5]||(i[5]=n=>l.editForm.end=n)},null,8,["modelValue"]),we]),_:1})]),u("div",ve,[t(b,{prop:"radio",class:"diygw-el-rate",label:"数据状态"},{default:o(()=>[t(A,{modelValue:l.editForm.radio,"onUpdate:modelValue":i[6]||(i[6]=n=>l.editForm.radio=n)},{default:o(()=>[(m(!0),q(le,null,ie(l.editFormData.radioDatas,n=>(m(),h(E,{key:n.value,label:n.value},{default:o(()=>[s(oe(n.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),_:1},8,["model","rules"])]),_:1},8,["fullscreen","modelValue"])]),Ce])}const Ke=X(se,[["render",ke],["__scopeId","data-v-34639ae0"]]);export{Ke as default};
