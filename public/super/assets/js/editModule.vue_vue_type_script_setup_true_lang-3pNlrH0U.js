import{l as q,m as B,h as R,i as E}from"./index-BfYElSN2.js";import{a as b}from"./element-plus-C9Ov05af.js";import{d as M,h as T,m as L,ag as s,aq as W,o as m,c,X as l,T as t,U as z,W as i,v as V,a as P,F as X,p as $,S as j,u as A,e as G}from"./@vue-CRBWlwId.js";const H={class:"system-menu-container"},J={style:{"font-size":"large"}},K={class:"dialog-footer"},ee=M({__name:"editModule",props:{title:{type:String,default:()=>""}},setup(h,{expose:x}){const{proxy:g}=G(),_=T(null),e=L({isShowDialog:!1,loading:!1,ruleForm:{deptId:0,deptName:"",parentId:0,orderNum:0,status:"",leader:"",phone:"",email:""},statusOptions:[],deptOptions:[],ruleRules:{deptName:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],parentId:[{required:!0,message:"父部门不能为空",trigger:"blur"}],status:[{required:!0,message:"部门状态不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"部门顺序不能为空",trigger:"blur"}],email:[{type:"email",message:"'请输入正确的邮箱地址",trigger:["blur","change"]}],phone:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}]}}),I=r=>{r.deptId&&r.deptId!=null&&r.deptId!=""?e.ruleForm=r:(f(),e.ruleForm.parentId=r.parentId),e.isShowDialog=!0,e.loading=!1,g.getDicts("sys_normal_disable").then(o=>{e.statusOptions=o.rows}),q("/sys/dept",{}).then(o=>{o.rows.unshift({deptId:0,deptName:"顶级部门"}),e.deptOptions=B(o.rows,"deptId","parentId","children")})},p=r=>{g.mittBus.emit("onEditDeptModule",r),e.isShowDialog=!1},y=()=>{p(),f()},N=()=>{const r=A(_);r&&r.validate(o=>{o&&(e.loading=!0,e.ruleForm.deptId!=null&&e.ruleForm.deptId!=0?R("/sys/dept",e.ruleForm).then(()=>{b.success("修改成功"),e.loading=!1,p(e.ruleForm)}).finally(()=>{e.loading=!1}):E("/sys/dept",e.ruleForm).then(()=>{b.success("新增成功"),e.loading=!1,p(e.ruleForm)}).finally(()=>{e.loading=!1}))})},f=()=>{e.ruleForm.deptId=0,e.ruleForm.deptName="",e.ruleForm.parentId=0,e.ruleForm.orderNum=0,e.ruleForm.status=e.ruleForm.status?e.ruleForm.status:"0",e.ruleForm.leader="",e.ruleForm.phone="",e.ruleForm.email=""};return x({openDialog:I}),(r,o)=>{const D=s("el-cascader"),d=s("el-form-item"),u=s("el-col"),n=s("el-input"),v=s("el-radio"),w=s("el-radio-group"),S=s("el-input-number"),U=s("el-row"),k=s("el-form"),F=s("el-button"),C=s("el-dialog"),O=W("drag");return m(),c("div",H,[l(C,{modelValue:e.isShowDialog,"onUpdate:modelValue":o[7]||(o[7]=a=>e.isShowDialog=a),width:"769px",center:""},{title:t(()=>[z((m(),c("div",J,[i(V(h.title),1)])),[[O,[".system-menu-container .el-dialog",".system-menu-container .el-dialog__header"]]])]),footer:t(()=>[P("span",K,[l(F,{onClick:y},{default:t(()=>[i("取 消")]),_:1}),l(F,{type:"primary",onClick:N,loading:e.loading},{default:t(()=>[i("编 辑")]),_:1},8,["loading"])])]),default:t(()=>[l(k,{model:e.ruleForm,rules:e.ruleRules,ref_key:"ruleFormRef",ref:_,"label-width":"80px"},{default:t(()=>[l(U,{gutter:30},{default:t(()=>[l(u,{span:24},{default:t(()=>[l(d,{label:"上级部门",prop:"parentId"},{default:t(()=>[l(D,{modelValue:e.ruleForm.parentId,"onUpdate:modelValue":o[0]||(o[0]=a=>e.ruleForm.parentId=a),options:e.deptOptions,class:"w100",props:{value:"deptId",label:"deptName",checkStrictly:!0,emitPath:!1},clearable:"",placeholder:"选择上级部门","show-all-levels":!1},null,8,["modelValue","options"])]),_:1})]),_:1}),l(u,{xs:24,sm:12,md:12,lg:12,xl:12},{default:t(()=>[l(d,{label:"部门名称",prop:"deptName"},{default:t(()=>[l(n,{modelValue:e.ruleForm.deptName,"onUpdate:modelValue":o[1]||(o[1]=a=>e.ruleForm.deptName=a),placeholder:"请输入部门名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{xs:24,sm:12,md:12,lg:12,xl:12},{default:t(()=>[l(d,{label:"负责人"},{default:t(()=>[l(n,{modelValue:e.ruleForm.leader,"onUpdate:modelValue":o[2]||(o[2]=a=>e.ruleForm.leader=a),placeholder:"请输入负责人",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{xs:24,sm:12,md:12,lg:12,xl:12},{default:t(()=>[l(d,{label:"联系电话",prop:"phone"},{default:t(()=>[l(n,{modelValue:e.ruleForm.phone,"onUpdate:modelValue":o[3]||(o[3]=a=>e.ruleForm.phone=a),placeholder:"请输入联系电话",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{xs:24,sm:12,md:12,lg:12,xl:12},{default:t(()=>[l(d,{label:"联系邮箱",prop:"email"},{default:t(()=>[l(n,{modelValue:e.ruleForm.email,"onUpdate:modelValue":o[4]||(o[4]=a=>e.ruleForm.email=a),placeholder:"请输入邮箱",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{xs:24,sm:12,md:12,lg:12,xl:12},{default:t(()=>[l(d,{label:"部门状态",prop:"status"},{default:t(()=>[l(w,{modelValue:e.ruleForm.status,"onUpdate:modelValue":o[5]||(o[5]=a=>e.ruleForm.status=a)},{default:t(()=>[(m(!0),c(X,null,$(e.statusOptions,a=>(m(),j(v,{key:a.dictValue,label:a.dictValue},{default:t(()=>[i(V(a.dictLabel),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(u,{xs:24,sm:12,md:12,lg:12,xl:12},{default:t(()=>[l(d,{label:"部门排序",prop:"orderNum"},{default:t(()=>[l(S,{modelValue:e.ruleForm.orderNum,"onUpdate:modelValue":o[6]||(o[6]=a=>e.ruleForm.orderNum=a),placeholder:"部门排序",clearable:"","controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});export{ee as _};
