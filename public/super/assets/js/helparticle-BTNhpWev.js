import{b as H,u as J}from"./vue-router-B8aOcPyE.js";import{s as K}from"./pinia-BTdriGDs.js";import{_ as Z,g as $,h as ee,i as te,j as v,l as le,k as ie,c as oe}from"./index-BfYElSN2.js";import{D as se}from"./uploadinput-CMX3D0tT.js";import{D as ae}from"./photo-CjUoS7r5.js";import{_ as ne}from"./index-DDnfpf_Y.js";import{ag as n,aq as re,o as c,c as k,a as m,X as t,T as o,W as u,U as S,S as h,x as C,Y as de,q as ue,F as q,p as P,v as me,bn as ce,bl as pe}from"./@vue-CRBWlwId.js";import{a as f,E as I}from"./element-plus-C9Ov05af.js";import"./vue-i18n-Bpsr_IBC.js";import"./@intlify-Bn43FqoL.js";import"./vue-DEEPytDe.js";import"./js-cookie-Cz0CWeBA.js";import"./@element-plus-tztFf6PP.js";import"./nprogress-B-yuMcN-.js";import"./axios-Ds1py3KQ.js";import"./lodash-CnNYTNB6.js";import"./mitt-DJ65BbbF.js";import"./file-saver-B2L8jjWN.js";import"./diygw-datav-DLF-c6uN.js";import"./lodash-es-CW97kIZl.js";import"./@vueuse-BIgT8fdk.js";import"./@popperjs-CER6Qr1e.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-r8A8W4xn.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-DwF5HINA.js";import"./escape-html-HzfLCvW4.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DuJrlvqV.js";import"./vue-draggable-plus-D90yCKwz.js";import"./vue-ueditor-wrap-B1amLqDs.js";const he={components:{DiyUploadinput:se,DiyPhoto:ae,DiyEditor:ne},data(){return{globalOption:{},userInfo:{},ordernum:{code:200,msg:"设置成功"},updatenum:{code:200,msg:"修改成功",data:{id:"1",sortnum:"0"}},cates:{rows:[{id:0,title:"",remark:null,img:"",sortnum:0,userId:0,createTime:"",updateTime:"",deleteTime:null}],total:0,code:0,msg:""},loading:!0,ids:[],single:!0,multiple:!0,title:"",total:0,tableData:[],isFullscreen:!1,isShowDialog:!1,saveloading:!1,editFormInit:{},queryParamsInit:{},editFormData:{statusDatas:[{value:"1",label:"有效"},{value:"2",label:"无效"}]},queryParams:{pageNum:1,pageSize:10,title_like:""},queryParamsRules:{},editForm:{id:void 0,title:"",cateId:"",remark:"",img:"",imgs:[],status:"1",content:""},editFormRules:{}}},methods:{getParamData(e,i){i=i||{};let a=e.currentTarget?e.currentTarget.dataset:e;return i&&(a=Object.assign(a,i)),a},navigateTo(e,i){let a=this.getParamData(e,i),{type:r}=a;r=="page"||r=="inner"||r=="href"?this.router.push({path:a.url,query:a}):typeof this[r]=="function"?this[r](a):f.error("待实现点击事件")},async init(){await this.catesApi()},async ordernumApi(e,i){e=e||{},e=this.getParamData(e);let a="/cms/helparticle/sortnum",r={},l={};if(r.id=e.id,!await this.confirmFunction({title:"确定置顶吗"})){f.error("你已取消");return}let g=await this.$http.post(a,r,l,"json");this.ordernum=g,this.resetQuery()},async updatenumApi(e,i){e=e||{},e=this.getParamData(e);let a="/cms/helparticle/update",r={},l={};if(r.id=e.id,r.sortnum=0,!await this.confirmFunction({title:"确定取消置顶吗"})){f.error("你已取消");return}let g=await this.$http.post(a,r,l,"json");this.updatenum=g,this.resetQuery()},async catesApi(e,i){e=e||{},e=this.getParamData(e);let a="/cms/helpcate/all",r={},l={},d=await this.$http.post(a,r,l,"json");this.cates=d},async confirmFunction(e){e=e||{};let i=this,a=e&&(e.title||e.title==0)?e.title:i.title||"";return new Promise(r=>{I({message:a,title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{r(!0)}).catch(()=>{r(!1)})})},openDialog(e){e.id&&e.id!=null&&e.id!=0?this.editForm=$(e,this.editForm):this.initForm(),this.isShowDialog=!0,this.saveloading=!1},closeDialog(e){this.mittBus.emit("onEditAdmintableModule",e),this.isShowDialog=!1},onSubmit(){const e=this.$refs.editFormRef;e&&e.validate((i,a)=>{if(i){if(this.saveloading=!0,this.editForm.skuType==2&&this.editForm.skus&&this.editForm.skus.skus.length==0){f.error("请设置多规格");return}this.editForm.id!=null&&this.editForm.id!=0?ee("/cms/helparticle",this.editForm).then(()=>{f.success("修改成功"),this.saveloading=!1,this.closeDialog(this.editForm)}).finally(()=>{this.saveloading=!1}):te("/cms/helparticle",this.editForm).then(()=>{f.success("新增成功"),this.saveloading=!1,this.closeDialog(this.editForm)}).finally(()=>{this.saveloading=!1})}else{let r="";a&&Object.keys(a).length>0&&(r=a[Object.keys(a)[0]].map(g=>g.message).join(",")),f.error("验证未通过！"+r)}})},initForm(){this.editForm=v(this.editFormInit)},handleQuery(){this.loading=!0,le("/cms/helparticle",this.queryParams).then(e=>{this.tableData=e.rows,this.total=e.total,this.loading=!1})},resetQuery(){this.queryParams=v(this.queryParamsInit),this.handleQuery()},onOpenAddModule(e){e=[],this.title="添加商品",this.openDialog(e)},onOpenEditModule(e){this.title="修改商品",this.initForm(),this.openDialog(e)},onTabelRowDel(e){let i=this;const a=e.id||this.ids;I({message:"是否确认删除选中的商品?",title:"警告",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return ie("/cms/helparticle",a).then(()=>{i.handleQuery(),f.success("删除成功")})})},handleSelectionChange(e){this.ids=e.map(i=>i.id),this.single=e.length!=1,this.multiple=!e.length},handleSizeChange(e){this.queryParams.pageSize=e,this.handleQuery()},handleCurrentChange(e){this.queryParams.pageNum=e,this.handleQuery()}},async mounted(){this.router=H(),this.globalOption=J().query;const e=oe(),{userInfos:i}=K(e);this.userInfo=i,await this.init(),this.editFormInit=v(this.editForm),this.queryParamsInit=v(this.queryParams),this.handleQuery(),this.mittBus.on("onEditAdmintableModule",()=>{this.handleQuery()})},beforeUnmount(){this.mittBus.off("onEditAdmintableModule")}},ge=e=>(ce("data-v-14e9b7a3"),e=e(),pe(),e),_e={class:"container"},fe={class:"el-card is-always-shadow diygw-col-24"},ye={class:"el-card__body"},be={class:"mb8"},we={class:"flex diygw-col-0"},Fe={class:"flex diygw-col-0"},ve={class:"mb8"},ke=["id"],Ce={class:"flex diygw-col-24"},xe={class:"flex diygw-col-24"},De={class:"flex diygw-col-24"},Ve={class:"flex diygw-col-24"},Se={class:"flex diygw-col-24"},qe={class:"flex diygw-col-24"},Pe={class:"flex diygw-col-24"},Ie={class:"dialog-footer flex justify-center"},Te=ge(()=>m("div",{class:"clearfix"},null,-1));function Re(e,i,a,r,l,d){const g=n("el-input"),_=n("el-form-item"),b=n("SvgIcon"),p=n("el-button"),x=n("el-form"),y=n("el-table-column"),F=n("el-tag"),T=n("diy-img"),R=n("el-table"),z=n("el-divider"),B=n("el-pagination"),U=n("FullScreen"),D=n("el-icon"),V=n("el-tooltip"),A=n("Remove"),Q=n("el-option"),E=n("el-select"),j=n("diy-uploadinput"),M=n("diy-photo"),O=n("el-radio"),N=n("el-radio-group"),W=n("diy-editor"),L=n("el-dialog"),X=re("loading");return c(),k("div",_e,[m("div",fe,[m("div",ye,[m("div",be,[t(x,{class:"flex flex-direction-row flex-wrap",model:l.queryParams,rules:l.queryParamsRules,ref:"queryForm","label-width":"80px"},{default:o(()=>[m("div",we,[t(_,{class:"diygw-el-rate",prop:"title_like",label:"标题"},{default:o(()=>[t(g,{type:"text",placeholder:"请输入标题查询",modelValue:l.queryParams.title_like,"onUpdate:modelValue":i[0]||(i[0]=s=>l.queryParams.title_like=s)},null,8,["modelValue"])]),_:1})]),m("div",Fe,[t(p,{type:"primary",onClick:d.handleQuery},{default:o(()=>[t(b,{name:"ele-Search"}),u(" 搜索 ")]),_:1},8,["onClick"]),u(),t(p,{onClick:d.resetQuery},{default:o(()=>[t(b,{name:"ele-Refresh"}),u(" 重置 ")]),_:1},8,["onClick"])])]),_:1},8,["model","rules"])]),m("div",ve,[t(p,{type:"primary",plain:"",onClick:d.onOpenAddModule},{default:o(()=>[t(b,{name:"ele-Plus"}),u("新增 ")]),_:1},8,["onClick"]),u(),t(p,{type:"danger",plain:"",disabled:l.multiple,onClick:d.onTabelRowDel},{default:o(()=>[t(b,{name:"ele-Delete"}),u("删除 ")]),_:1},8,["disabled","onClick"])]),S((c(),h(R,{onSelectionChange:d.handleSelectionChange,data:l.tableData,stripe:"",border:"","current-row-key":"id","empty-text":"没有数据",style:{width:"100%"}},{default:o(()=>[t(y,{type:"selection",width:"55",align:"center"}),t(y,{label:"置顶",prop:"title",align:"center"},{default:o(s=>[s.row.sortnum>0?(c(),h(F,{key:0,style:{cursor:"pointer"},type:"error",onClick:w=>d.updatenumApi(s.row)},{default:o(()=>[u(" 取消置顶 ")]),_:2},1032,["onClick"])):(c(),h(F,{key:1,style:{cursor:"pointer"},onClick:w=>d.ordernumApi(s.row)},{default:o(()=>[u(" 置顶 ")]),_:2},1032,["onClick"]))]),_:1}),t(y,{label:"图片",prop:"img",align:"center"},{default:o(s=>[t(T,{style:{width:"80px",height:"80px"},src:s.row.img,fit:"contain"},null,8,["src"])]),_:1}),t(y,{label:"标题",prop:"title",align:"center"}),t(y,{label:"备注",prop:"remark",align:"center"}),t(y,{label:"数据状态",prop:"status",align:"center"},{default:o(s=>[s.row.status==1?(c(),h(F,{key:0},{default:o(()=>[u(" 上架 ")]),_:1})):(c(),h(F,{key:1},{default:o(()=>[u(" 下架 ")]),_:1}))]),_:1}),t(y,{label:"操作",align:"center",fixed:"right",width:"180"},{default:o(s=>[t(p,{type:"primary",plain:"",size:"small",onClick:w=>d.onOpenEditModule(s.row)},{default:o(()=>[t(b,{name:"ele-Edit"}),u("修改 ")]),_:2},1032,["onClick"]),u(),s.row.id!=0?(c(),h(p,{key:0,type:"danger",plain:"",size:"small",onClick:w=>d.onTabelRowDel(s.row)},{default:o(()=>[t(b,{name:"ele-Delete"}),u("删除 ")]),_:2},1032,["onClick"])):C("",!0)]),_:1})]),_:1},8,["onSelectionChange","data"])),[[X,l.loading]]),S(m("div",null,[t(z),u(),t(B,{background:"",total:l.total,"current-page":l.queryParams.pageNum,"page-size":l.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:d.handleSizeChange,onCurrentChange:d.handleCurrentChange},null,8,["total","current-page","page-size","onSizeChange","onCurrentChange"])],512),[[de,l.total>0]])]),t(L,{fullscreen:l.isFullscreen,width:"1000px",modelValue:l.isShowDialog,"onUpdate:modelValue":i[10]||(i[10]=s=>l.isShowDialog=s),"destroy-on-close":"",title:"商品",draggable:"",center:""},{header:o(({close:s,titleId:w,titleClass:Y})=>[m("h4",{id:w,class:ue(Y)},"商品",10,ke),l.isFullscreen?C("",!0):(c(),h(V,{key:0,content:"最大化",placement:"bottom"},{default:o(()=>[t(p,{class:"diygw-max-icon el-dialog__headerbtn"},{default:o(()=>[t(D,{onClick:i[1]||(i[1]=G=>l.isFullscreen=!l.isFullscreen)},{default:o(()=>[t(U)]),_:1})]),_:1})]),_:1})),l.isFullscreen?(c(),h(V,{key:1,content:"返回",placement:"bottom"},{default:o(()=>[t(p,{class:"diygw-max-icon el-dialog__headerbtn"},{default:o(()=>[t(D,{onClick:i[2]||(i[2]=G=>l.isFullscreen=!l.isFullscreen)},{default:o(()=>[t(A)]),_:1})]),_:1})]),_:1})):C("",!0)]),footer:o(()=>[m("div",Ie,[t(p,{onClick:d.closeDialog},{default:o(()=>[u(" 取 消 ")]),_:1},8,["onClick"]),u(),t(p,{type:"primary",onClick:d.onSubmit,loading:l.saveloading},{default:o(()=>[u(" 保 存 ")]),_:1},8,["onClick","loading"])])]),default:o(()=>[t(x,{class:"flex flex-direction-row flex-wrap",model:l.editForm,rules:l.editFormRules,ref:"editFormRef","label-width":"90px"},{default:o(()=>[m("div",Ce,[t(_,{rules:[{required:!0,trigger:"blur",message:"商品名称不能为空"}],class:"diygw-el-rate",prop:"title",label:"标题"},{default:o(()=>[t(g,{type:"text",placeholder:"请输入标题",modelValue:l.editForm.title,"onUpdate:modelValue":i[3]||(i[3]=s=>l.editForm.title=s)},null,8,["modelValue"])]),_:1})]),m("div",xe,[t(_,{prop:"cateId",class:"diygw-el-rate",label:"分类"},{default:o(()=>[t(E,{"clear-icon":"CircleClose","suffix-icon":"ArrowUp",placeholder:"请选择",modelValue:l.editForm.cateId,"onUpdate:modelValue":i[4]||(i[4]=s=>l.editForm.cateId=s),style:{width:"100% !important"}},{default:o(()=>[(c(!0),k(q,null,P(l.cates.rows,s=>(c(),h(Q,{key:s.id,label:s.title,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),m("div",De,[t(_,{prop:"remark",class:"diygw-el-rate",label:"描述"},{default:o(()=>[t(g,{type:"textarea",rows:"3",placeholder:"请输入描述",modelValue:l.editForm.remark,"onUpdate:modelValue":i[5]||(i[5]=s=>l.editForm.remark=s)},null,8,["modelValue"])]),_:1})]),m("div",Ve,[t(_,{rules:[{required:!0,trigger:"blur",message:"商品主图不能为空"}],prop:"img",class:"diygw-el-rate",label:"主图"},{default:o(()=>[t(j,{modelValue:l.editForm.img,"onUpdate:modelValue":i[6]||(i[6]=s=>l.editForm.img=s),title:"主图"},null,8,["modelValue"])]),_:1})]),m("div",Se,[t(_,{prop:"imgs",class:"diygw-el-rate",label:"轮播图"},{default:o(()=>[t(M,{modelValue:l.editForm.imgs,"onUpdate:modelValue":i[7]||(i[7]=s=>l.editForm.imgs=s)},null,8,["modelValue"])]),_:1})]),m("div",qe,[t(_,{prop:"status",class:"diygw-el-rate",label:"数据状态"},{default:o(()=>[t(N,{modelValue:l.editForm.status,"onUpdate:modelValue":i[8]||(i[8]=s=>l.editForm.status=s)},{default:o(()=>[(c(!0),k(q,null,P(l.editFormData.statusDatas,s=>(c(),h(O,{key:s.value,label:s.value},{default:o(()=>[u(me(s.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),m("div",Pe,[t(_,{rules:[{required:!0,trigger:"blur",message:"商品详情不能为空哟"}],prop:"content",class:"diygw-el-rate",label:"内容详情"},{default:o(()=>[t(W,{modelValue:l.editForm.content,"onUpdate:modelValue":i[9]||(i[9]=s=>l.editForm.content=s)},null,8,["modelValue"])]),_:1})])]),_:1},8,["model","rules"])]),_:1},8,["fullscreen","modelValue"])]),Te])}const mt=Z(he,[["render",Re],["__scopeId","data-v-14e9b7a3"]]);export{mt as default};
